Single Stock - Long Call:
record_type,id,sheet_name,cell,range,sheet_role,hidden,used_range,label_cell,input_type,validation,default_value,notes,formula_text,calc_category,procedural_steps,dependencies,outputs_to,output_id,output_cell,output_type,is_static,static_text,immediate_source,root_dependencies,lineage_summary,engine_key,engine_output_category,expected_datatype,injection_id,injection_cell_or_range,injection_priority,drives_output_ids,drives_output_cells,legs_detected,legs_table_ranges,leg_index,leg_position_cell,leg_type_cell,leg_strike_cell,leg_expiry_cell,leg_premium_cell,leg_delta_cell,flag_type,flag_details
WORKBOOK_METADATA,WB_000001,,,,,,,,,,,"{""file_name"": ""Single Stock_Long Call.xlsx"", ""has_macros_detected"": false, ""named_ranges_detected"": true, ""external_links_detected"": true, ""circular_references_detected"": false}",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
SHEET,,speculative call,,,output,FALSE,C1:R73,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
SHEET,,data,,,data,FALSE,A1:AC356,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
INPUT,INP_000001,data,data!E7,,,,,data!D7,ticker_equity,,MSFT US,boundary input (engine-populated),,,,,,,,,,,,,,ticker_symbol,,text,,,,,,,,,,,,,,,,
INPUT,INP_000002,data,data!E8,,,,,data!D8,ticker_option,,MSFT 3/20/26 C420 EQUITY,boundary input (engine-populated),,,,,,,,,,,,,,option_symbol,,text,,,,,,,,,,,,,,,,
INPUT,INP_000003,data,data!E9,,,,,data!D9,quantity,,19,boundary input (engine-populated),,,,,,,,,,,,,,contracts,,number,,,,,,,,,,,,,,,,
INPUT,INP_000004,data,data!E10,,,,,data!D10,other,,Neutral,boundary input (engine-populated),,,,,,,,,,,,,,research_rating,,text,,,,,,,,,,,,,,,,
INPUT,INP_000005,data,data!E11,,,,,data!D11,other,,49,boundary input (engine-populated),,,,,,,,,,,,,,research_target_price,,number,,,,,,,,,,,,,,,,
BLOOMBERG_FIELD,BBG_000001,data,data!E4,,,,,,,,,BDP destination to be replaced by Python (classification: BDP),"=_xll.BDP(C4,$E$3)",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
BLOOMBERG_FIELD,BBG_000002,data,data!X4,,,,,,,,,BDP destination to be replaced by Python (classification: BDP),"=_xll.BDP(W4,$X$2)",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
BLOOMBERG_FIELD,BBG_000003,speculative call,speculative call!F12,,,,,,,,,BDP destination to be replaced by Python (classification: BDP),"=_xll.BDP(data!C4,""Chg Pct 1D"")/100",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
BLOOMBERG_FIELD,BBG_000004,speculative call,speculative call!F13,,,,,,,,,BDP destination to be replaced by Python (classification: BDP),"=_xll.BDP(data!C4,""Chg net 1D"")",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
BLOOMBERG_FIELD,BBG_000005,speculative call,speculative call!G15,,,,,,,,,BDP destination to be replaced by Python (classification: BDP),"=_xll.BDP(data!E$8,""opt expire dt"")",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
BLOOMBERG_FIELD,BBG_000006,speculative call,speculative call!G16,,,,,,,,,BDP destination to be replaced by Python (classification: BDP),"=_xll.BDP(data!E$8,""opt strike px"")",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
BLOOMBERG_FIELD,BBG_000007,speculative call,speculative call!G18,,,,,,,,,BDP destination to be replaced by Python (classification: BDP),"=ROUNDUP(_xll.BDP(data!E$8,""PX MID""),1)",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
BLOOMBERG_FIELD,BBG_000008,speculative call,speculative call!G19,,,,,,,,,BDP destination to be replaced by Python (classification: BDP),"=_xll.BDP(data!E$8,""opt delta ask"")",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
BLOOMBERG_FIELD,BBG_000009,speculative call,speculative call!N10,,,,,,,,,BDP destination to be replaced by Python (classification: BDP),"=_xll.BDP(data!C4,""High 52Week"")",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
BLOOMBERG_FIELD,BBG_000010,speculative call,speculative call!N11,,,,,,,,,BDP destination to be replaced by Python (classification: BDP),"=_xll.BDP(data!C4,""low 52Week"")",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
BLOOMBERG_FIELD,BBG_000011,speculative call,speculative call!N13,,,,,,,,,BDP destination to be replaced by Python (classification: BDP),"=_xll.BDP(F8&"" EQUITY"",""expected report dt"")",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
LEAF_OUTPUT,,speculative call,,,,,,,,,,,"=""""&F9&"" trading below strike price of $""&G16",,,,,OUT_000001,speculative call!D24,text_displayed,FALSE,,speculative call!F9,,python_injection -> existing template formulas -> pdf cell,,,,,,,,,,,,,,,,
LEAF_OUTPUT,,speculative call,,,,,,,,,,,"=""""&F9&"" trading above strike price of $""&G16",,,,,OUT_000002,speculative call!D28,text_displayed,FALSE,,speculative call!F9,,python_injection -> existing template formulas -> pdf cell,,,,,,,,,,,,,,,,
LEAF_OUTPUT,,speculative call,,,,,,,,,,,=data!E4,,,,,OUT_000003,speculative call!F10,value_displayed,FALSE,,data!E4,BBG_000001,python_injection -> existing template formulas -> pdf cell,,,,,,,,,,,,,,,,
LEAF_OUTPUT,,speculative call,,,,,,,,,,,=F10N12,,,,,OUT_000004,speculative call!F11,value_displayed,FALSE,,speculative call!F10,,python_injection -> existing template formulas -> pdf cell,,,,,,,,,,,,,,,,
LEAF_OUTPUT,,speculative call,,,,,,,,,,,"=_xll.BDP(data!C4,""Chg Pct 1D"")/100",,,,,OUT_000005,speculative call!F12,text_displayed,FALSE,,data!C4,BBG_000003,python_injection -> existing template formulas -> pdf cell,,,,,,,,,,,,,,,,
LEAF_OUTPUT,,speculative call,,,,,,,,,,,"=_xll.BDP(data!C4,""Chg net 1D"")",,,,,OUT_000006,speculative call!F13,text_displayed,FALSE,,data!C4,BBG_000004,python_injection -> existing template formulas -> pdf cell,,,,,,,,,,,,,,,,
LEAF_OUTPUT,,speculative call,,,,,,,,,,,"=(""""If at expiration, ""&F8&"" is trading below the call strike of ""&G16&"", the call will expire worthless and the investor will have a loss equal to the initial speculative investment of ""&TEXT(N16,""$0,000"")&"" per share."""")",,,,,OUT_000007,speculative call!F24,text_displayed,FALSE,,speculative call!F8,,python_injection -> existing template formulas -> pdf cell,,,,,,,,,,,,,,,,
LEAF_OUTPUT,,speculative call,,,,,,,,,,,"=""If ""&F8&"" is trading above the call strike of ""&G16&"" at expiration, the investor will have the right but not the obligation to buy ""&TEXT((J15100),""#,###000"")&"" shares of ""&F8&"" at ""&TEXT(G16,""$0.00"")&"". The investor may also decide to sell their speculative calls in the open market for intrinsic value.""",,,,,OUT_000008,speculative call!F28,text_displayed,FALSE,,speculative call!F8,,python_injection -> existing template formulas -> pdf cell,,,,,,,,,,,,,,,,
LEAF_OUTPUT,,speculative call,,,,,,,,,,,=data!E7,,,,,OUT_000009,speculative call!F8,value_displayed,FALSE,,data!E7,INP_000001,python_injection -> existing template formulas -> pdf cell,,,,,,,,,,,,,,,,
LEAF_OUTPUT,,speculative call,,,,,,,,,,,=data!X4,,,,,OUT_000010,speculative call!F9,value_displayed,FALSE,,data!X4,BBG_000002,python_injection -> existing template formulas -> pdf cell,,,,,,,,,,,,,,,,
LEAF_OUTPUT,,speculative call,,,,,,,,,,,"=_xll.BDP(data!E$8,""opt expire dt"")",,,,,OUT_000011,speculative call!G15,text_displayed,FALSE,,data!E8,BBG_000005;INP_000002,python_injection -> existing template formulas -> pdf cell,,,,,,,,,,,,,,,,
Single Stock - Long Put:
record_type,id,sheet_name,cell,range,sheet_role,hidden,used_range,label_cell,input_type,validation,default_value,notes,formula_text,calc_category,procedural_steps,dependencies,outputs_to,output_id,output_cell,output_type,is_static,static_text,immediate_source,root_dependencies,lineage_summary,engine_key,engine_output_category,expected_datatype,injection_id,injection_cell_or_range,injection_priority,drives_output_ids,drives_output_cells,legs_detected,legs_table_ranges,leg_index,leg_position_cell,leg_type_cell,leg_strike_cell,leg_expiry_cell,leg_premium_cell,leg_delta_cell,flag_type,flag_details
WORKBOOK_METADATA,,,"","","","","","","","","","{""file_name"":""Single Stock_Long Put.xlsx"",""has_macros_detected"":false,""named_ranges_detected"":true,""external_links_detected"":true,""circular_references_detected"":false}","","","","","","","","","","","","","","","","","","","","","","","","","","",""
SHEET,,data,,,"data",false,"A1:AC356","","","","","Used as staging (market/option/inputs/dividend schedule).","","","","","","","","","","","","","","","","","","","","","","","","","","",""
SHEET,,Output,,,"output",false,"A1:R63","","","","","Formatted PDF template sheet; print area present: 'Output'!$C$1:$P$132.","","","","","","","","","","","","","","","","","","","","","","","","","","",""
SHEET,,Calc,,,"calc",false,"A1:M26","","","","","Commission calculator / desk-use schedule; may not be PDF-visible.","","","","","","","","","","","","","","","","","","","","","","","","","","",""
INPUT,INP_000001,data!B25,,input,false,"A1:AC356",data!A25,ticker_equity,none,MSFT US,"Underlying ticker input used to drive staging and template values.","","","","","","","","","","","","","INP_000001","","","","","","","","","","","","","","",""
INPUT,INP_000002,data!B26,,input,false,"A1:AC356",data!A26,notional,none,2244000,"Notional value input (if put) used for sizing/contracts.","","","","","","","","","","","","","INP_000002","","","","","","","","","","","","","","",""
INPUT,INP_000003,data!B27,,input,false,"A1:AC356",data!A27,ticker_option,none,MSFT US 03/20/26 P370 Equity,"Option ticker/symbol input identifying hedge leg.","","","","","","","","","","","","","INP_000003","","","","","","","","","","","","","","",""
INPUT,INP_000004,data!B28,,input,false,"A1:AC356",data!A28,quantity,none,56,"Contracts input used in Proposed Trade and costs.","","","","","","","","","","","","","INP_000004","","","","","","","","","","","","","","",""
LEAF_OUTPUT,,Output!C1:P132,,,"output",false,"A1:R63","","","","","Aggregated LEAF OUTPUT range for PDF-visible template (dynamic values, dates, computed metrics, and narrative within print area).","","","","","","OUT_000001","Output!C1:P132","value_displayed",false,"","Upstream staging (data sheet) and/or calc sheet feed template cells in this print area.","INP_000001;INP_000002;INP_000003;INP_000004","INJ_000001/INJ_000002 -> Output print area","template_print_area","print_meta","array_2d","","","","","","","","","","","","","","",""
PYTHON_INJECTION,,data,,,"data",false,"A1:AC356","","","","","Primary stable staging block for market + option leg + precomputed strategy metrics used by Output sheet. Overwrite as a contiguous block to preserve template behavior.","","","","","","","","","","","","","","market_and_metrics_block","market_data","array_2d","INJ_000001","data!A24:AC60","P0","OUT_000001","Output!C1:P132","","","","","","","","","","",""
PYTHON_INJECTION,,data,,,"data",false,"A1:AC356","","","","","Projected dividends schedule table; required because Output shows estimated dividends to expiration and may reference upcoming dividends list. Populate table rows as provided by engine.","","","","","","","","","","","","","","dividend_schedule_table","market_data","array_2d","INJ_000002","data!A61:E120","P0","OUT_000001","Output!C1:P132","","","","","","","","","","",""
LEGS_SUMMARY,,data,,,"data",false,"A1:AC356","","","","","Detected single-leg strategy (Protective Put / Long Put) based on populated template content.","","","","","","","","","","","","","","","","","","",1,"data!A24:AC40","","","","","","","","","",""
LEG_FIELD,,data,,,"data",false,"A1:AC356","","","","","Leg 1 location approximated to staging block containing option symbol/strike/expiry/premium/delta. Populate via INJ_000001.","","","","","","","","","","","","","","","","","","",1,"data!A24:AC40",1,"data!B27","data!A27","data!N24","data!O24","data!S24","data!W24","",""
FLAG,,Output,,,"output",false,"A1:R63","","","","","External links exist in workbook package; ensure Python-writing does not break link structures or calculation chain.","","","","","","","","","","","","","","","","","","","","","","","","","EXTERNAL_LINK","Found xl/externalLinks/externalLink1.xml (+ rels). Recommend stripping or validating links in automation."
FLAG,,data,,,"data",false,"A1:AC356","","","","","Named ranges detected but invalid ( #REF!); automation should not rely on them.","","","","","","","","","","","","","","","","","","","","","","","","","NAMED_RANGE_DETECTED","2 named ranges found: expire, EXPIRES -> data! #REF! (invalid)."
FLAG,,Output,,,"output",false,"A1:R63","","","","","Template likely contains volatile date/timestamp logic (e.g., TODAY/NOW) for the as-of date line; prefer Python to inject as_of_date to staging block to avoid volatility.","","","","","","","","","","","","","","","","","","","","","","","","","VOLATILE_FUNCTION","Potential volatility risk in date header; mitigate by injecting as_of_date/as_of_date_text in INJ_000001."


Single Stock - Covered Call:
record_type,id,sheet_name,cell,range,sheet_role,hidden,used_range,label_cell,input_type,validation,default_value,notes,formula_text,calc_category,procedural_steps,dependencies,outputs_to,output_id,output_cell,output_type,is_static,static_text,immediate_source,root_dependencies,lineage_summary,engine_key,engine_output_category,expected_datatype,injection_id,injection_cell_or_range,injection_priority,drives_output_ids,drives_output_cells,legs_detected,legs_table_ranges,leg_index,leg_position_cell,leg_type_cell,leg_strike_cell,leg_expiry_cell,leg_premium_cell,leg_delta_cell,flag_type,flag_details
WORKBOOK_METADATA,WB_000001,,,,,,,,,,,"{""file_name"":""Single Stock_Covered Call_Overwrite.xlsx"",""has_macros_detected"":false,""named_ranges_detected"":true,""external_links_detected"":true,""circular_references_detected"":false}",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
SHEET,SHEET_000001,DIV,,,other,true,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
SHEET,SHEET_000002,data,,,data,false,A1:AC356,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
SHEET,SHEET_000003,output,,,output,false,D1:R53,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
INPUT,INP_000001,data,data!E7,,,,,data!D7,ticker_equity,,MSFT US,Ticker,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
INPUT,INP_000002,data,data!E8,,,,,data!D8,ticker_option,,MSFT 3/20/26 C420 EQUITY,Option,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
INPUT,INP_000003,data,data!E9,,,,,data!D9,quantity,,4500,Shares,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
INPUT,INP_000004,data,data!E10,,,,,data!D10,other,,Neutral,GRP Rating,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
INPUT,INP_000005,data,data!E11,,,,,data!D11,other,,500,Target Price,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
INPUT,INP_000006,data,data!E12,,,,,data!D12,other,,Most Preferred,CIO Rating,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
BLOOMBERG_FIELD,BBG_000001,data,,data!E4:O4,,,,,,,,_xll.BDP destinations for spot/option fields plus volatile TODAY-derived dates,BDP,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
BLOOMBERG_FIELD,BBG_000002,data,,data!X4:Y4,,,,,,,,_xll.BDP destinations for underlying name and gics sector,BDP,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
BLOOMBERG_FIELD,BBG_000003,output,,output!O8:O10,,,,,,,,_xll.BDP dividend yield and 52-week high/low,BDP,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
BLOOMBERG_FIELD,BBG_000004,output,,output!F10:F11,,,,,,,,_xll.BDP day % change and day $ change,BDP,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
BLOOMBERG_FIELD,BBG_000005,output,,output!H10,,,,,,,,_xll.BDP expected report date,BDP,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
BLOOMBERG_FIELD,BBG_000006,output,,output!O33:O34,,,,,,,,_xll.BDP 6m implied vol and vol percentile,BDP,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
CALCULATION,CALC_000001,data,data!T4,,,,,,,,,,"=SUMIF(A16:A36,"">=""&($A$2),B16:B36)-SUMIF(A16:A36,"">""&(H4),B16:B36)",dividend_sum,sumif dividend_schedule|subtract post-expiry dividends,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
CALCULATION,CALC_000002,output,output!N1,,,,,,,,,,"=TEXT(TODAY(),""dd mmmm yyyy"")",print_date,format today as dd mmmm yyyy,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
LEAF_OUTPUT,,output,,,,,,,,,,,"=TEXT(TODAY(),""dd mmmm yyyy"")",,,,,OUT_000001,output!N1,text_displayed,false,,FORMULA,CALC_000002,INJ_000005 -> output!N1,,,,,,,,,,,,,,,,,,,
LEAF_OUTPUT,,output,,,,,,,,,,,=data!E7,,,,,OUT_000002,output!F6,value_displayed,false,,data!E7,INP_000001,INJ_000001 -> output!F6,,,,,,,,,,,,,,,,,,,
LEAF_OUTPUT,,output,,,,,,,,,,,=data!E10,,,,,OUT_000003,output!O6,value_displayed,false,,data!E10,INP_000004,INJ_000001 -> output!O6,,,,,,,,,,,,,,,,,,,
LEAF_OUTPUT,,output,,,,,,,,,,,=data!X4,,,,,OUT_000004,output!F7,value_displayed,false,,data!X4,BBG_000002,INJ_000004 -> output!F7,,,,,,,,,,,,,,,,,,,
LEAF_OUTPUT,,output,,,,,,,,,,,=data!E11,,,,,OUT_000005,output!O7,value_displayed,false,,data!E11,INP_000005,INJ_000001 -> output!O7,,,,,,,,,,,,,,,,,,,
LEAF_OUTPUT,,output,,,,,,,,,,,"=IF(data!Y4="" #N/A N/A"",""ETF"",data!Y4)",,,,,OUT_000006,output!F8,value_displayed,false,,FORMULA,BBG_000002,INJ_000004 -> output!F8,,,,,,,,,,,,,,,,,,,
LEAF_OUTPUT,,output,,,,,,,,,,,"=IF(ISERROR(_xll.BDP(F6&"" equity"",""eqy dvd yld ind"")/100),0,_xll.BDP(F6&"" equity"",""eqy dvd yld ind"")/100)",,,,,OUT_000007,output!O8,text_displayed,false,,BLOOMBERG_ADDIN_FORMULA,BBG_000003,INJ_000006 -> output!O8,,,,,,,,,,,,,,,,,,,
LEAF_OUTPUT,,output,,,,,,,,,,,=data!E4,,,,,OUT_000008,output!F9,value_displayed,false,,data!E4,BBG_000001,INJ_000002 -> output!F9,,,,,,,,,,,,,,,,,,,
LEAF_OUTPUT,,output,,,,,,,,,,,"=_xll.BDP(F6&"" equity"",""high 52week"")",,,,,OUT_000009,output!O9,text_displayed,false,,output!F6,BBG_000003,INJ_000006 -> output!O9,,,,,,,,,,,,,,,,,,,
LEAF_OUTPUT,,output,,,,,,,,,,,"=_xll.BDP(data!C4,""Chg Pct 1D"")/100",,,,,OUT_000010,output!F10,value_displayed,false,,data!C4,BBG_000004,INJ_000007 -> output!F10,,,,,,,,,,,,,,,,,,,
LEAF_OUTPUT,,output,,,,,,,,,,,"=_xll.BDP(F6&"" EQUITY"",""expected report dt"")",,,,,OUT_000011,output!H10,text_displayed,false,,output!F6,BBG_000005,INJ_000008 -> output!H10,,,,,,,,,,,,,,,,,,,
LEAF_OUTPUT,,output,,,,,,,,,,,"=_xll.BDP(F6&"" equity"",""low 52week"")",,,,,OUT_000012,output!O10,text_displayed,false,,output!F6,BBG_000003,INJ_000006 -> output!O10,,,,,,,,,,,,,,,,,,,
LEAF_OUTPUT,,output,,,,,,,,,,,"=_xll.BDP(data!C4,""Chg net 1D"")",,,,,OUT_000013,output!F11,value_displayed,false,,data!C4,BBG_000004,INJ_000007 -> output!F11,,,,,,,,,,,,,,,,,,,
LEAF_OUTPUT,,output,,,,,,,,,,,=data!E12,,,,,OUT_000014,output!O11,value_displayed,false,,data!E12,INP_000006,INJ_000001 -> output!O11,,,,,,,,,,,,,,,,,,,
LEAF_OUTPUT,,output,,,,,,,,,,,=data!J4,,,,,OUT_000015,output!F13,value_displayed,false,,data!J4,BBG_000001,INJ_000002 -> output!F13,,,,,,,,,,,,,,,,,,,
LEAF_OUTPUT,,output,,,,,,,,,,,=data!E9,,,,,OUT_000016,output!J13,value_displayed,false,,data!E9,INP_000003,INJ_000001 -> output!J13,,,,,,,,,,,,,,,,,,,
LEAF_OUTPUT,,output,,,,,,,,,,,=F6,,,,,OUT_000017,output!K13,value_displayed,false,,output!F6,INP_000001,INJ_000001 -> output!K13,,,,,,,,,,,,,,,,,,,
LEAF_OUTPUT,,output,,,,,,,,,,,= F9,,,,,OUT_000018,output!L13,value_displayed,false,,output!F9,BBG_000001,INJ_000002 -> output!L13,,,,,,,,,,,,,,,,,,,
LEAF_OUTPUT,,output,,,,,,,,,,,=J13*L13,,,,,OUT_000019,output!O13,value_displayed,false,,FORMULA,BBG_000001;INP_000003,INJ_000001;INJ_000002 -> output!O13,,,,,,,,,,,,,,,,,,,
LEAF_OUTPUT,,output,,,,,,,,,,,=data!G4,,,,,OUT_000020,output!F14,value_displayed,false,,data!G4,BBG_000001,INJ_000002 -> output!F14,,,,,,,,,,,,,,,,,,,
LEAF_OUTPUT,,output,,,,,,,,,,,=J13/100,,,,,OUT_000021,output!J14,value_displayed,false,,output!J13,INP_000003,INJ_000001 -> output!J14,,,,,,,,,,,,,,,,,,,
LEAF_OUTPUT,,output,,,,,,,,,,,=F13,,,,,OUT_000022,output!K14,value_displayed,false,,output!F13,BBG_000001,INJ_000002 -> output!K14,,,,,,,,,,,,,,,,,,,
LEAF_OUTPUT,,output,,,,,,,,,,,"=F14&"" Strike Call @ $""&TEXT(F16,""0.00"")",,,,,OUT_000023,output!L14,text_displayed,false,,FORMULA,BBG_000001,INJ_000002 -> output!L14,,,,,,,,,,,,,,,,,,,
LEAF_OUTPUT,,output,,,,,,,,,,,=F16*J13,,,,,OUT_000024,output!O14,value_displayed,false,,FORMULA,BBG_000001;INP_000003,INJ_000001;INJ_000002 -> output!O14,,,,,,,,,,,,,,,,,,,
LEAF_OUTPUT,,output,,,,,,,,,,,=data!AB4,,,,,OUT_000025,output!F15,value_displayed,false,,data!AB4,BBG_000001,INJ_000002 -> output!F15,,,,,,,,,,,,,,,,,,,
LEAF_OUTPUT,,output,,,,,,,,,,,"=""Position Value if ""&F6&"" is unchanged at Expiry""",,,,,OUT_000026,output!I15,text_displayed,false,,output!F6,INP_000001,INJ_000001 -> output!I15,,,,,,,,,,,,,,,,,,,
LEAF_OUTPUT,,output,,,,,,,,,,,=SUM(O13:P14),,,,,OUT_000027,output!O15,value_displayed,false,,FORMULA,BBG_000001;INP_000003,INJ_000001;INJ_000002 -> output!O15,,,,,,,,,,,,,,,,,,,
LEAF_OUTPUT,,output,,,,,,,,,,,=data!K4,,,,,OUT_000028,output!F16,value_displayed,false,,data!K4,BBG_000001,INJ_000002 -> output!F16,,,,,,,,,,,,,,,,,,,
LEAF_OUTPUT,,output,,,,,,,,,,,=F18*J13,,,,,OUT_000029,output!O16,value_displayed,false,,FORMULA,CALC_000001;INP_000003,INJ_000001;INJ_000003 -> output!O16,,,,,,,,,,,,,,,,,,,
LEAF_OUTPUT,,output,,,,,,,,,,,=data!O4,,,,,OUT_000030,output!F17,value_displayed,false,,data!O4,BBG_000001,INJ_000002 -> output!F17,,,,,,,,,,,,,,,,,,,
LEAF_OUTPUT,,output,,,,,,,,,,,=O16+(O14),,,,,OUT_000031,output!O17,value_displayed,false,,FORMULA,BBG_000001;CALC_000001;INP_000003,INJ_000001;INJ_000002;INJ_000003 -> output!O17,,,,,,,,,,,,,,,,,,,
LEAF_OUTPUT,,output,,,,,,,,,,,=data!T4,,,,,OUT_000032,output!F18,value_displayed,false,,data!T4,CALC_000001,INJ_000003 -> output!F18,,,,,,,,,,,,,,,,,,,
LEAF_OUTPUT,,output,,,,,,,,,,,=F14*J13,,,,,OUT_000033,output!O18,value_displayed,false,,FORMULA,BBG_000001;INP_000003,INJ_000001;INJ_000002 -> output!O18,,,,,,,,,,,,,,,,,,,
LEAF_OUTPUT,,output,,,,,,,,,,,=F13-TODAY(),,,,,OUT_000034,output!F19,value_displayed,false,,output!F13,BBG_000001,INJ_000002 -> output!F19,,,,,,,,,,,,,,,,,,,
LEAF_OUTPUT,,output,,,,,,,,,,,=((F14-F9)+F16+F18)*J13,,,,,OUT_000035,output!O19,value_displayed,false,,FORMULA,BBG_000001;CALC_000001;INP_000003,INJ_000001;INJ_000002;INJ_000003 -> output!O19,,,,,,,,,,,,,,,,,,,
LEAF_OUTPUT,,output,,,,,,,,,,,=F9-F16,,,,,OUT_000036,output!F20,value_displayed,false,,FORMULA,BBG_000001,INJ_000002 -> output!F20,,,,,,,,,,,,,,,,,,,
LEAF_OUTPUT,,output,,,,,,,,,,,=(F18+F16)/F9,,,,,OUT_000037,output!K20,value_displayed,false,,FORMULA,BBG_000001;CALC_000001,INJ_000002;INJ_000003 -> output!K20,,,,,,,,,,,,,,,,,,,
LEAF_OUTPUT,,output,,,,,,,,,,,=(F14-(F9-F16-F18))/F9,,,,,OUT_000038,output!O20,value_displayed,false,,FORMULA,BBG_000001;CALC_000001,INJ_000002;INJ_000003 -> output!O20,,,,,,,,,,,,,,,,,,,
LEAF_OUTPUT,,output,,,,,,,,,,,=(F20-F9)/F9,,,,,OUT_000039,output!F21,value_displayed,false,,FORMULA,BBG_000001,INJ_000002 -> output!F21,,,,,,,,,,,,,,,,,,,
LEAF_OUTPUT,,output,,,,,,,,,,,"=IF((F13-TODAY())<60,""-"",(365/(F13-TODAY()))*K20)",,,,,OUT_000040,output!K21,value_displayed,false,,FORMULA,BBG_000001;CALC_000001,INJ_000002;INJ_000003 -> output!K21,,,,,,,,,,,,,,,,,,,
LEAF_OUTPUT,,output,,,,,,,,,,,"=IF((F13-TODAY())<60,""-"",(365/(F13-TODAY()))*O20)",,,,,OUT_000041,output!O21,value_displayed,false,,FORMULA,BBG_000001;CALC_000001,INJ_000002;INJ_000003 -> output!O21,,,,,,,,,,,,,,,,,,,
LEAF_OUTPUT,,output,,,,,,,,,,,"=""Max Appreciation ""&TEXT(R22,""$#,##"")",,,,,OUT_000042,output!Q22,text_displayed,false,,output!R22,BBG_000001;CALC_000001;INP_000003,INJ_000001;INJ_000002;INJ_000003 -> output!Q22,,,,,,,,,,,,,,,,,,,
LEAF_OUTPUT,,output,,,,,,,,,,,"=ROUND(O19,2)",,,,,OUT_000043,output!R22,value_displayed,false,,output!O19,BBG_000001;CALC_000001;INP_000003,INJ_000001;INJ_000002;INJ_000003 -> output!R22,,,,,,,,,,,,,,,,,,,
LEAF_OUTPUT,,output,,,,,,,,,,,"=""""&F7&"" trading below strike price of ""&""$""&F14",,,,,OUT_000044,output!D23,text_displayed,false,,FORMULA,BBG_000001;BBG_000002,INJ_000002;INJ_000004 -> output!D23,,,,,,,,,,,,,,,,,,,
LEAF_OUTPUT,,output,,,,,,,,,,,"=(""Generally, written call options trading below their respective strike price will expire unexercised at expiration and the investor will keep the premium received from the sale. In the example above, the investor will receive ""&TEXT(F16,""$0.00"")&"" in option premium""&IF(F18=0,"""","" and ""&TEXT(F18,""$0.00"")&"" in dividends during the life of the option for a total of ""&TEXT((F18+F16),""$#,###0.00""))&"" per share or ""&TEXT(O17,""$#,###0.00"")&"" total. If the stock remains unchanged at option expiration, the investor will have a ""&TEXT(K20,""0.0%"")&"" simple return."")",,,,,OUT_000045,output!F23,text_displayed,false,,FORMULA,BBG_000001;CALC_000001;INP_000003,INJ_000001;INJ_000002;INJ_000003 -> output!F23,,,,,,,,,,,,,,,,,,,
LEAF_OUTPUT,,output,,,,,,,,,,,"=""If-Called Simple Return ""&ROUND(O20*100,2)&""%""",,,,,OUT_000046,output!Q23,text_displayed,false,,output!O20,BBG_000001;CALC_000001,INJ_000002;INJ_000003 -> output!Q23,,,,,,,,,,,,,,,,,,,
LEAF_OUTPUT,,output,,,,,,,,,,,"=F7&"" Current Stock Price ""&TEXT(F9,""$0.00"")",,,,,OUT_000047,output!Q24,text_displayed,false,,FORMULA,BBG_000001;BBG_000002,INJ_000002;INJ_000004 -> output!Q24,,,,,,,,,,,,,,,,,,,
LEAF_OUTPUT,,output,,,,,,,,,,,"=""""&F7&"" trading above strike price of ""&""$""&F14",,,,,OUT_000048,output!D27,text_displayed,false,,FORMULA,BBG_000001;BBG_000002,INJ_000002;INJ_000004 -> output!D27,,,,,,,,,,,,,,,,,,,
LEAF_OUTPUT,,output,,,,,,,,,,,"=IF(F6="""","""",IF(F9>F14,Q27,""If the stock is above $""&F14&"" and the call option is assigned, the net gain would be ""&TEXT((F14-F9),""$0.00"")&"" (""&TEXT(F14,""$00"")&"" - ""&TEXT(F9,""$0.00"")&"")""&"" from the gain on the stock plus ""&TEXT(F16,""$0.00"")&"" option premium received from the sale of the call resulting in an effective sale price of ""&TEXT((F14+F16),""$0.00"")&"" per share. ""&IF(F18=0,"""",""Assuming the short call is not assigned until expiration, the investor would also receive dividends paid over the life of the option or ""&TEXT(F18,""$0.00"")&"" per share."")&"" This scenario would result in appreciation of +""&TEXT(O20,""0.0%"")&"" from current market valuation.""))",,,,,OUT_000049,output!F27,text_displayed,false,,FORMULA,BBG_000001;CALC_000001;INP_000001,INJ_000001;INJ_000002;INJ_000003 -> output!F27,,,,,,,,,,,,,,,,,,,
LEAF_OUTPUT,,output,,,,,,,,,,,"=""Breakeven Price ""&TEXT(F20,""$0.00"")",,,,,OUT_000050,output!Q31,text_displayed,false,,output!F20,BBG_000001,INJ_000002 -> output!Q31,,,,,,,,,,,,,,,,,,,
LEAF_OUTPUT,,output,,,,,,,,,,,"=F14&"" Strike Price""",,,,,OUT_000051,output!Q32,text_displayed,false,,output!F14,BBG_000001,INJ_000002 -> output!Q32,,,,,,,,,,,,,,,,,,,
LEAF_OUTPUT,,output,,,,,,,,,,,"=_xll.BDP(F6&"" equity"",""6mth impvol 100.0%mny df"")/100",,,,,OUT_000052,output!O33,text_displayed,false,,output!F6,BBG_000006,INJ_000009 -> output!O33,,,,,,,,,,,,,,,,,,,
LEAF_OUTPUT,,output,,,,,,,,,,,"=_xll.BDP(F6&"" equity"",""vol percentile"",""vol term"",""6m"")/100",,,,,OUT_000053,output!O34,text_displayed,false,,output!F6,BBG_000006,INJ_000009 -> output!O34,,,,,,,,,,,,,,,,,,,
LEAF_OUTPUT,,output,,,,,,,,,,,"="" ^Pricing is HIGHLY indicative on ""&TEXT(TODAY(),""mmmm dd, yyyy"")",,,,,OUT_000054,output!D52,text_displayed,false,,FORMULA,,output!D52,,,,,,,,,,,,,,,,,,,
LEAF_OUTPUT,,output,,,,,,,,,,,=NOW(),,,,,OUT_000055,output!J52,value_displayed,false,,FORMULA,,output!J52,,,,,,,,,,,,,,,,,,,
PYTHON_INJECTION,,,,,,,,,,,,"Overwrite input values in existing Inputs block in order [ticker, option, shares, grp_rating, target_price, cio_rating].",,,,,,,,,,,,,,inputs_block,other,array_1d,INJ_000001,data!E7:E12,P0,OUT_000045;OUT_000049;OUT_000002;OUT_000026;OUT_000016;OUT_000021;OUT_000017;OUT_000014;OUT_000019;OUT_000024;OUT_000027;OUT_000029;OUT_000031;OUT_000033;OUT_000035;OUT_000003;OUT_000005;OUT_000042;OUT_000043,output!F23;output!F27;output!F6;output!I15;output!J13;output!J14;output!K13;output!O11;output!O13;output!O14;output!O15;output!O16;output!O17;output!O18;output!O19;output!O6;output!O7;output!Q22;output!R22,,,,,,,,,,,
PYTHON_INJECTION,,,,,,,,,,,,"Overwrite row4 staging values (replaces Bloomberg + volatile TODAY logic) for E4:O4 = [spot_price, opt_name, strike, expiry, days_to_expiry, expiry_date, premium_mid, impl_vol_bid, vol_90d, spread, delta].",,,,,,,,,,,,,,staging_row4_market_and_leg,market_data,array_1d,INJ_000002,data!E4:O4,P0,OUT_000044;OUT_000048;OUT_000015;OUT_000020;OUT_000025;OUT_000028;OUT_000030;OUT_000034;OUT_000036;OUT_000039;OUT_000045;OUT_000049;OUT_000008;OUT_000022;OUT_000037;OUT_000040;OUT_000018;OUT_000023;OUT_000019;OUT_000024;OUT_000027;OUT_000031;OUT_000033;OUT_000035;OUT_000038;OUT_000041;OUT_000042;OUT_000046;OUT_000047;OUT_000050;OUT_000051;OUT_000043,output!D23;output!D27;output!F13;output!F14;output!F15;output!F16;output!F17;output!F19;output!F20;output!F21;output!F23;output!F27;output!F9;output!K14;output!K20;output!K21;output!L13;output!L14;output!O13;output!O14;output!O15;output!O17;output!O18;output!O19;output!O20;output!O21;output!Q22;output!Q23;output!Q24;output!Q31;output!Q32;output!R22,,,,,,,,,,,
PYTHON_INJECTION,,,,,,,,,,,,Overwrite T4 (dividends_to_expiration) and U4 (trade_cost) to avoid SUMIF/TODAY dependency and broken external link in U4.,,,,,,,,,,,,,,dividend_and_cost_summaries,strategy_metrics,array_1d,INJ_000003,data!T4:U4,P0,OUT_000032;OUT_000045;OUT_000049;OUT_000037;OUT_000040;OUT_000029;OUT_000031;OUT_000035;OUT_000038;OUT_000041;OUT_000042;OUT_000046;OUT_000043,output!F18;output!F23;output!F27;output!K20;output!K21;output!O16;output!O17;output!O19;output!O20;output!O21;output!Q22;output!Q23;output!R22,,,,,,,,,,,
PYTHON_INJECTION,,,,,,,,,,,,Overwrite stock name (X4) and GICS sector name (Y4) which are Bloomberg destinations used on PDF.,,,,,,,,,,,,,,underlying_descriptors,market_data,array_1d,INJ_000004,data!X4:Y4,P0,OUT_000044;OUT_000048;OUT_000004;OUT_000006;OUT_000047,output!D23;output!D27;output!F7;output!F8;output!Q24,,,,,,,,,,,
PYTHON_INJECTION,,,,,,,,,,,,"Overwrite PDF header date text to avoid volatile TODAY(). Format ""dd mmmm yyyy"".",,,,,,,,,,,,,,as_of_date_text,print_meta,text,INJ_000005,output!N1,P1,OUT_000001,output!N1,,,,,,,,,,,
PYTHON_INJECTION,,,,,,,,,,,,"Overwrite Bloomberg add-in outputs on output sheet: O8 dividend_yield, O9 high_52w, O10 low_52w.",,,,,,,,,,,,,,underlying_yield_and_52wk_range,market_data,array_1d,INJ_000006,output!O8:O10,P0,OUT_000012;OUT_000007;OUT_000009,output!O10;output!O8;output!O9,,,,,,,,,,,
PYTHON_INJECTION,,,,,,,,,,,,"Overwrite Bloomberg add-in outputs: F10 day_pct_change, F11 day_change_dollars.",,,,,,,,,,,,,,day_change_metrics,market_data,array_1d,INJ_000007,output!F10:F11,P0,OUT_000010;OUT_000013,output!F10;output!F11,,,,,,,,,,,
PYTHON_INJECTION,,,,,,,,,,,,Overwrite Bloomberg expected report date.,,,,,,,,,,,,,,expected_earnings_date,market_data,date,INJ_000008,output!H10,P0,OUT_000011,output!H10,,,,,,,,,,,
PYTHON_INJECTION,,,,,,,,,,,,Overwrite Bloomberg 6m implied vol and vol percentile rank.,,,,,,,,,,,,,,volatility_stats_6m,market_data,array_1d,INJ_000009,output!O33:O34,P0,OUT_000052;OUT_000053,output!O33;output!O34,,,,,,,,,,,
LEGS_SUMMARY,LEGS_000001,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,2,output!D13:O14,,,,,,,,,
LEG_FIELD,LEG_000001,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,2,output!D13:O14,1,output!I13,output!K13,,,,,,
LEG_FIELD,LEG_000002,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,2,output!D13:O14,2,output!I14,output!L14,data!G4,data!J4,data!K4,data!O4,,
FLAG,,,,data!A2;data!I4;data!J4;output!D52;output!F19;output!J52;output!K21;output!N1;output!O21,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,VOLATILE_FUNCTION,"volatile_funcs=TODAY,NOW,OFFSET,INDIRECT,RAND,RANDBETWEEN count=9"
FLAG,,,,data!U4,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,EXTERNAL_LINK,external_formula_cells=1 examples=data!U4
FLAG,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,NAMED_RANGE_DETECTED,named_ranges_count=2 broken_refs_count=2 names=expire;EXPIRES
FLAG,,,,DIV!<empty>,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,OTHER_RISK,Sheet DIV is hidden and has empty used_range; not on dependency path (unused).


Single Stock - Cash Secured Put:
record_type,id,sheet_name,cell,range,sheet_role,hidden,used_range,label_cell,input_type,validation,default_value,notes,formula_text,calc_category,procedural_steps,dependencies,outputs_to,output_id,output_cell,output_type,is_static,static_text,immediate_source,root_dependencies,lineage_summary,engine_key,engine_output_category,expected_datatype,injection_id,injection_cell_or_range,injection_priority,drives_output_ids,drives_output_cells,legs_detected,legs_table_ranges,leg_index,leg_position_cell,leg_type_cell,leg_strike_cell,leg_expiry_cell,leg_premium_cell,leg_delta_cell,flag_type,flag_details
WORKBOOK_METADATA,WB_000001,,,,,,,,,,,"{""file_name"":""Single Stock_Short Put.xlsx"",""has_macros_detected"":false,""named_ranges_detected"":true,""external_links_detected"":false,""circular_references_detected"":false}"
SHEET,SHEET_000001,data,,,data,false,A1:AC356
SHEET,SHEET_000002,Cash-Secured,,,output,false,D1:S65
SHEET,SHEET_000003,DIV,,,data,true,
SHEET,SHEET_000004,Sheet1,,,other,true,
INPUT,INP_000001,data,data!E7,,data,,,data!D7,ticker_equity,,MSFT US,Underlying ticker (template key)
INPUT,INP_000002,data,data!E8,,data,,,data!D8,ticker_option,,MSFT US 03/20/26 P380 Equity,Short option ticker (leg identifier)
INPUT,INP_000003,data,data!E9,,data,,,data!D9,quantity,,10,Contracts
INPUT,INP_000004,data,data!E10,,data,,,data!D10,other,,Buy,IB Rating text
INPUT,INP_000005,data,data!E11,,data,,,data!D11,other,,600,Target Price
INPUT,INP_000006,data,data!E12,,data,,,data!D12,other,,Bellwether,CIO Rating text
INPUT,INP_000007,Cash-Secured,Cash-Secured!Q1,,output,,,,rate,,,T-bill yield used for accrual (referenced by M23)
INPUT,INP_000008,Cash-Secured,Cash-Secured!Q23,,output,,,,rate,,0.0429,T-bill yield displayed in narrative (referenced by I23)
INPUT,INP_000009,Cash-Secured,Cash-Secured!N1,,output,,,,other,,(overwrite TODAY),Report date display should be frozen by engine
INPUT,INP_000010,Cash-Secured,Cash-Secured!I62,,output,,,,other,,(overwrite NOW),Pricing timestamp should be frozen by engine
INPUT,INP_000011,Cash-Secured,Cash-Secured!K62,,output,,,,other,,(overwrite TODAY),Pricing disclaimer text should be frozen by engine
INPUT,INP_000012,Cash-Secured,Cash-Secured!G21,,output,,,,other,,(overwrite TODAY),Days-to-expiry should be frozen by engine
BLOOMBERG_FIELD,BBG_000001,data,data!E4,,data,,,,,,,PX LAST,=_xll.BDP(C4,$E$3)
BLOOMBERG_FIELD,BBG_000002,data,data!X4,,data,,,,,,,NAME,=_xll.BDP(W4,$X$2)
BLOOMBERG_FIELD,BBG_000003,data,data!Y4,,data,,,,,,,GICS sector name,=_xll.BDP(W4,$Y$2)
BLOOMBERG_FIELD,BBG_000004,Cash-Secured,Cash-Secured!F13,,output,,,,,,,Chg Pct 1D,=_xll.BDP(data!C4,"Chg Pct 1D")/100
BLOOMBERG_FIELD,BBG_000005,Cash-Secured,Cash-Secured!I13,,output,,,,,,,Chg Net 1D,=_xll.BDP(data!C4,"Chg Net 1D")
BLOOMBERG_FIELD,BBG_000006,Cash-Secured,Cash-Secured!N11,,output,,,,,,,Dividend yield,=IF(ISERROR(_xll.BDP(F9&" equity","eqy dvd yld ind")/100),0,_xll.BDP(F9&" equity","eqy dvd yld ind")/100)
BLOOMBERG_FIELD,BBG_000007,Cash-Secured,Cash-Secured!N12,,output,,,,,,,High 52Week,=_xll.BDP(data!C4,"High 52Week")
BLOOMBERG_FIELD,BBG_000008,Cash-Secured,Cash-Secured!N13,,output,,,,,,,Low 52Week,=_xll.BDP(data!C4,"low 52Week")
BLOOMBERG_FIELD,BBG_000009,Cash-Secured,Cash-Secured!G16,,output,,,,,,,Opt expire dt,=_xll.BDP(data!E$8,"opt expire dt")
BLOOMBERG_FIELD,BBG_000010,Cash-Secured,Cash-Secured!G17,,output,,,,,,,Opt strike px,=_xll.BDP(data!E$8,"opt strike px")
BLOOMBERG_FIELD,BBG_000011,Cash-Secured,Cash-Secured!G19,,output,,,,,,,Option PX MID,=ROUNDDOWN(_xll.BDP(data!E$8,"PX MID"),1)
BLOOMBERG_FIELD,BBG_000012,Cash-Secured,Cash-Secured!G20,,output,,,,,,,Opt delta mid,=_xll.BDP(data!E$8,"opt delta mid")
BLOOMBERG_FIELD,BBG_000013,Cash-Secured,Cash-Secured!G22,,output,,,,,,,Expected report dt,=_xll.BDP(F9&" EQUITY","expected report dt")
BLOOMBERG_FIELD,BBG_000014,Cash-Secured,Cash-Secured!M21,,output,,,,,,,Mov avg 200d,=_xll.BDP(F9&" EQUITY","mov avg 200d")
LEAF_OUTPUT,,,Cash-Secured,,,,,,,,,,,,,,,OUT_000001,Cash-Secured!D25,text_displayed,false,,FORMULA,BBG_000002;BBG_000010,roots -> Excel formulas -> OUT_000001
LEAF_OUTPUT,,,Cash-Secured,,,,,,,,,,,,,,,OUT_000002,Cash-Secured!D29,text_displayed,false,,FORMULA,BBG_000002;BBG_000010,roots -> Excel formulas -> OUT_000002
LEAF_OUTPUT,,,Cash-Secured,,,,,,,,,,,,,,,OUT_000003,Cash-Secured!D63,text_displayed,false,,FORMULA,BBG_000002,roots -> Excel formulas -> OUT_000003
LEAF_OUTPUT,,,Cash-Secured,,,,,,,,,,,,,,,OUT_000004,Cash-Secured!F9,value_displayed,false,,data!E7,INP_000001,roots -> Excel formulas -> OUT_000004
LEAF_OUTPUT,,,Cash-Secured,,,,,,,,,,,,,,,OUT_000005,Cash-Secured!F10,value_displayed,false,,data!X4,BBG_000002,roots -> Excel formulas -> OUT_000005
LEAF_OUTPUT,,,Cash-Secured,,,,,,,,,,,,,,,OUT_000006,Cash-Secured!F11,value_displayed,false,,FORMULA,BBG_000003,roots -> Excel formulas -> OUT_000006
LEAF_OUTPUT,,,Cash-Secured,,,,,,,,,,,,,,,OUT_000007,Cash-Secured!F12,value_displayed,false,,data!E4,BBG_000001,roots -> Excel formulas -> OUT_000007
LEAF_OUTPUT,,,Cash-Secured,,,,,,,,,,,,,,,OUT_000008,Cash-Secured!F13,value_displayed,false,,FORMULA,BBG_000004,roots -> Excel formulas -> OUT_000008
LEAF_OUTPUT,,,Cash-Secured,,,,,,,,,,,,,,,OUT_000009,Cash-Secured!F25,text_displayed,false,,FORMULA,BBG_000002;BBG_000010;BBG_000011;INP_000003,roots -> Excel formulas -> OUT_000009
LEAF_OUTPUT,,,Cash-Secured,,,,,,,,,,,,,,,OUT_000010,Cash-Secured!F29,text_displayed,false,,FORMULA,BBG_000002;BBG_000010;BBG_000011;INP_000003,roots -> Excel formulas -> OUT_000010
LEAF_OUTPUT,,,Cash-Secured,,,,,,,,,,,,,,,OUT_000011,Cash-Secured!G16,value_displayed,false,,FORMULA,BBG_000009,roots -> Excel formulas -> OUT_000011
LEAF_OUTPUT,,,Cash-Secured,,,,,,,,,,,,,,,OUT_000012,Cash-Secured!G17,value_displayed,false,,FORMULA,BBG_000010,roots -> Excel formulas -> OUT_000012
LEAF_OUTPUT,,,Cash-Secured,,,,,,,,,,,,,,,OUT_000013,Cash-Secured!G18,value_displayed,false,,FORMULA,BBG_000001;BBG_000010,roots -> Excel formulas -> OUT_000013
LEAF_OUTPUT,,,Cash-Secured,,,,,,,,,,,,,,,OUT_000014,Cash-Secured!G19,value_displayed,false,,FORMULA,BBG_000011,roots -> Excel formulas -> OUT_000014
LEAF_OUTPUT,,,Cash-Secured,,,,,,,,,,,,,,,OUT_000015,Cash-Secured!G20,value_displayed,false,,FORMULA,BBG_000012,roots -> Excel formulas -> OUT_000015
LEAF_OUTPUT,,,Cash-Secured,,,,,,,,,,,,,,,OUT_000016,Cash-Secured!G21,value_displayed,false,,FORMULA,INP_000012,roots -> Excel formulas -> OUT_000016
LEAF_OUTPUT,,,Cash-Secured,,,,,,,,,,,,,,,OUT_000017,Cash-Secured!G22,value_displayed,false,,FORMULA,BBG_000013,roots -> Excel formulas -> OUT_000017
LEAF_OUTPUT,,,Cash-Secured,,,,,,,,,,,,,,,OUT_000018,Cash-Secured!I13,value_displayed,false,,FORMULA,BBG_000005,roots -> Excel formulas -> OUT_000018
LEAF_OUTPUT,,,Cash-Secured,,,,,,,,,,,,,,,OUT_000019,Cash-Secured!I23,text_displayed,false,,FORMULA,INP_000008,roots -> Excel formulas -> OUT_000019
LEAF_OUTPUT,,,Cash-Secured,,,,,,,,,,,,,,,OUT_000020,Cash-Secured!I62,value_displayed,false,,FORMULA,INP_000010,roots -> Excel formulas -> OUT_000020
LEAF_OUTPUT,,,Cash-Secured,,,,,,,,,,,,,,,OUT_000021,Cash-Secured!J16,value_displayed,false,,data!E9,INP_000003,roots -> Excel formulas -> OUT_000021
LEAF_OUTPUT,,,Cash-Secured,,,,,,,,,,,,,,,OUT_000022,Cash-Secured!K16,text_displayed,false,,FORMULA,BBG_000009,roots -> Excel formulas -> OUT_000022
LEAF_OUTPUT,,,Cash-Secured,,,,,,,,,,,,,,,OUT_000023,Cash-Secured!K62,text_displayed,false,,FORMULA,INP_000011,roots -> Excel formulas -> OUT_000023
LEAF_OUTPUT,,,Cash-Secured,,,,,,,,,,,,,,,OUT_000024,Cash-Secured!L16,text_displayed,false,,FORMULA,BBG_000010,roots -> Excel formulas -> OUT_000024
LEAF_OUTPUT,,,Cash-Secured,,,,,,,,,,,,,,,OUT_000025,Cash-Secured!M19,value_displayed,false,,FORMULA,BBG_000010;BBG_000011,roots -> Excel formulas -> OUT_000025
LEAF_OUTPUT,,,Cash-Secured,,,,,,,,,,,,,,,OUT_000026,Cash-Secured!M20,value_displayed,false,,FORMULA,BBG_000010;BBG_000011;INP_000003;INP_000007;INP_000012,roots -> Excel formulas -> OUT_000026
LEAF_OUTPUT,,,Cash-Secured,,,,,,,,,,,,,,,OUT_000027,Cash-Secured!M21,value_displayed,false,,FORMULA,BBG_000014,roots -> Excel formulas -> OUT_000027
LEAF_OUTPUT,,,Cash-Secured,,,,,,,,,,,,,,,OUT_000028,Cash-Secured!M22,value_displayed,false,,FORMULA,BBG_000010;INP_000003,roots -> Excel formulas -> OUT_000028
LEAF_OUTPUT,,,Cash-Secured,,,,,,,,,,,,,,,OUT_000029,Cash-Secured!M23,value_displayed,false,,FORMULA,BBG_000010;INP_000003;INP_000007;INP_000012,roots -> Excel formulas -> OUT_000029
LEAF_OUTPUT,,,Cash-Secured,,,,,,,,,,,,,,,OUT_000030,Cash-Secured!N1,text_displayed,false,,FORMULA,INP_000009,roots -> Excel formulas -> OUT_000030
LEAF_OUTPUT,,,Cash-Secured,,,,,,,,,,,,,,,OUT_000031,Cash-Secured!N9,value_displayed,false,,data!E10,INP_000004,roots -> Excel formulas -> OUT_000031
LEAF_OUTPUT,,,Cash-Secured,,,,,,,,,,,,,,,OUT_000032,Cash-Secured!N10,value_displayed,false,,data!E11,INP_000005,roots -> Excel formulas -> OUT_000032
LEAF_OUTPUT,,,Cash-Secured,,,,,,,,,,,,,,,OUT_000033,Cash-Secured!N11,value_displayed,false,,FORMULA,BBG_000006,roots -> Excel formulas -> OUT_000033
LEAF_OUTPUT,,,Cash-Secured,,,,,,,,,,,,,,,OUT_000034,Cash-Secured!N12,value_displayed,false,,FORMULA,BBG_000007,roots -> Excel formulas -> OUT_000034
LEAF_OUTPUT,,,Cash-Secured,,,,,,,,,,,,,,,OUT_000035,Cash-Secured!N13,value_displayed,false,,FORMULA,BBG_000008,roots -> Excel formulas -> OUT_000035
LEAF_OUTPUT,,,Cash-Secured,,,,,,,,,,,,,,,OUT_000036,Cash-Secured!N14,value_displayed,false,,data!E12,INP_000006,roots -> Excel formulas -> OUT_000036
LEAF_OUTPUT,,,Cash-Secured,,,,,,,,,,,,,,,OUT_000037,Cash-Secured!N15,value_displayed,false,,FORMULA,BBG_000010;INP_000003,roots -> Excel formulas -> OUT_000037
LEAF_OUTPUT,,,Cash-Secured,,,,,,,,,,,,,,,OUT_000038,Cash-Secured!N16,text_displayed,false,,FORMULA,BBG_000011,roots -> Excel formulas -> OUT_000038
LEAF_OUTPUT,,,Cash-Secured,,,,,,,,,,,,,,,OUT_000039,Cash-Secured!N17,value_displayed,false,,FORMULA,BBG_000011;INP_000003,roots -> Excel formulas -> OUT_000039
LEAF_OUTPUT,,,Cash-Secured,,,,,,,,,,,,,,,OUT_000040,Cash-Secured!N18,value_displayed,false,,FORMULA,BBG_000010;BBG_000011;INP_000003;INP_000007;INP_000012,roots -> Excel formulas -> OUT_000040
LEAF_OUTPUT,,,Cash-Secured,,,,,,,,,,,,,,,OUT_000041,Cash-Secured!N19,value_displayed,false,,FORMULA,BBG_000001;BBG_000010;BBG_000011,roots -> Excel formulas -> OUT_000041
LEAF_OUTPUT,,,Cash-Secured,,,,,,,,,,,,,,,OUT_000042,Cash-Secured!N20,value_displayed,false,,FORMULA,BBG_000010;BBG_000011;INP_000003;INP_000007;INP_000012,roots -> Excel formulas -> OUT_000042
LEAF_OUTPUT,,,Cash-Secured,,,,,,,,,,,,,,,OUT_000043,Cash-Secured!N21,value_displayed,false,,FORMULA,BBG_000010;BBG_000011;BBG_000014,roots -> Excel formulas -> OUT_000043
PYTHON_INJECTION,,,data,,,,,,,,,,,,,,,,,,,,,,,,inputs_block,other,array_1d,INJ_000001,data!E7:E12,P0,OUT_000004;OUT_000021;OUT_000031;OUT_000032;OUT_000036,Cash-Secured!F9;Cash-Secured!J16;Cash-Secured!N9;Cash-Secured!N10;Cash-Secured!N14,1,data!A3:AC4
PYTHON_INJECTION,,,data,,,,,,,,,,,,,,,,,,,,,,,,spot_price,market_data,number,INJ_000002,data!E4,P0,OUT_000007;OUT_000013;OUT_000041,Cash-Secured!F12;Cash-Secured!G18;Cash-Secured!N19,1,data!A3:AC4
PYTHON_INJECTION,,,data,,,,,,,,,,,,,,,,,,,,,,,,underlying_meta,market_data,array_1d,INJ_000003,data!X4:Y4,P0,OUT_000001;OUT_000002;OUT_000003;OUT_000005;OUT_000006;OUT_000009;OUT_000010,Cash-Secured!D25;Cash-Secured!D29;Cash-Secured!D63;Cash-Secured!F10;Cash-Secured!F11;Cash-Secured!F25;Cash-Secured!F29,1,data!A3:AC4
PYTHON_INJECTION,,,Cash-Secured,,,,,,,,,,,,,,,,,,,,,,,,leg1_option_block,leg_params,array_1d,INJ_000004,Cash-Secured!G16:G20,P0,OUT_000011;OUT_000012;OUT_000013;OUT_000014;OUT_000015;OUT_000022;OUT_000024;OUT_000025;OUT_000028;OUT_000037;OUT_000038;OUT_000039;OUT_000041;OUT_000043,Cash-Secured!G16;Cash-Secured!G17;Cash-Secured!G18;Cash-Secured!G19;Cash-Secured!G20;Cash-Secured!K16;Cash-Secured!L16;Cash-Secured!M19;Cash-Secured!M22;Cash-Secured!N15;Cash-Secured!N16;Cash-Secured!N17;Cash-Secured!N19;Cash-Secured!N21,1,data!A3:AC4
PYTHON_INJECTION,,,Cash-Secured,,,,,,,,,,,,,,,,,,,,,,,,day_chg_pct_1d,market_data,number,INJ_000005,Cash-Secured!F13,P0,OUT_000008,Cash-Secured!F13,1,data!A3:AC4
PYTHON_INJECTION,,,Cash-Secured,,,,,,,,,,,,,,,,,,,,,,,,day_chg_net_1d,market_data,number,INJ_000006,Cash-Secured!I13,P0,OUT_000018,Cash-Secured!I13,1,data!A3:AC4
PYTHON_INJECTION,,,Cash-Secured,,,,,,,,,,,,,,,,,,,,,,,,equity_stats_block,market_data,array_1d,INJ_000007,Cash-Secured!N11:N13,P0,OUT_000033;OUT_000034;OUT_000035,Cash-Secured!N11;Cash-Secured!N12;Cash-Secured!N13,1,data!A3:AC4
PYTHON_INJECTION,,,Cash-Secured,,,,,,,,,,,,,,,,,,,,,,,,expected_report_dt,market_data,date,INJ_000008,Cash-Secured!G22,P0,OUT_000017,Cash-Secured!G22,1,data!A3:AC4
PYTHON_INJECTION,,,Cash-Secured,,,,,,,,,,,,,,,,,,,,,,,,moving_avg_200d,market_data,number,INJ_000009,Cash-Secured!M21,P0,OUT_000027;OUT_000043,Cash-Secured!M21;Cash-Secured!N21,1,data!A3:AC4
PYTHON_INJECTION,,,Cash-Secured,,,,,,,,,,,,,,,,,,,,,,,,t_bill_yield,print_meta,number,INJ_000010,Cash-Secured!Q1,P0,OUT_000029;OUT_000026;OUT_000040;OUT_000042,Cash-Secured!M23;Cash-Secured!M20;Cash-Secured!N18;Cash-Secured!N20,1,data!A3:AC4
PYTHON_INJECTION,,,Cash-Secured,,,,,,,,,,,,,,,,,,,,,,,,t_bill_yield_display,print_meta,number,INJ_000011,Cash-Secured!Q23,P0,OUT_000019,Cash-Secured!I23,1,data!A3:AC4
PYTHON_INJECTION,,,Cash-Secured,,,,,,,,,,,,,,,,,,,,,,,,report_date_text,print_meta,text,INJ_000012,Cash-Secured!N1,P0,OUT_000030,Cash-Secured!N1,1,data!A3:AC4
PYTHON_INJECTION,,,Cash-Secured,,,,,,,,,,,,,,,,,,,,,,,,days_to_expiry,strategy_metrics,number,INJ_000013,Cash-Secured!G21,P0,OUT_000016;OUT_000029;OUT_000026;OUT_000042,Cash-Secured!G21;Cash-Secured!M23;Cash-Secured!M20;Cash-Secured!N20,1,data!A3:AC4
PYTHON_INJECTION,,,Cash-Secured,,,,,,,,,,,,,,,,,,,,,,,,pricing_stamp_block,print_meta,array_1d,INJ_000014,Cash-Secured!I62:K62,P0,OUT_000020;OUT_000023,Cash-Secured!I62;Cash-Secured!K62,1,data!A3:AC4
LEGS_SUMMARY,LEG_SUM_000001,data,,,,data,false,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,1,data!A3:AC4
LEG_FIELD,LEG_000001,Cash-Secured,,,output,false,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,1,data!A3:AC4,1,data!E9,Cash-Secured!G15,Cash-Secured!G17,Cash-Secured!G16,Cash-Secured!G19,Cash-Secured!G20
FLAG,FLAG_000001,,,,,,,,,,,"Volatile functions detected; overwrite to freeze outputs",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,VOLATILE_FUNCTION,"count=7; cells=data!A2;data!I4;data!J4;Cash-Secured!N1;Cash-Secured!G21;Cash-Secured!I62;Cash-Secured!K62"
FLAG,FLAG_000002,,,,,,,,,,,"Named ranges detected (some invalid #REF!)",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,NAMED_RANGE_DETECTED,"count=2; invalid_count=2; names=expire;EXPIRES"


Single Stock - Bull Call Spread:
record_type,id,sheet_name,cell,range,sheet_role,hidden,used_range,label_cell,input_type,validation,default_value,notes,formula_text,calc_category,procedural_steps,dependencies,outputs_to,output_id,output_cell,output_type,is_static,static_text,immediate_source,root_dependencies,lineage_summary,engine_key,engine_output_category,expected_datatype,injection_id,injection_cell_or_range,injection_priority,drives_output_ids,drives_output_cells,legs_detected,legs_table_ranges,leg_index,leg_position_cell,leg_type_cell,leg_strike_cell,leg_expiry_cell,leg_premium_cell,leg_delta_cell,flag_type,flag_details
WORKBOOK_METADATA,,,,,,,,,,,,"{""file_name"":""Single Stock_Bull Call Spread.xlsm"",""has_macros_detected"":false,""named_ranges_detected"":false,""external_links_detected"":true,""circular_references_detected"":false} citeturn1search1",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
SHEET,,DIV,,,lookup,true,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
SHEET,,Graph,,,chart,true,A1:D26,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
SHEET,,data,,,data,false,A1:AC356,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
SHEET,,output,,,output,false,A1:R60,,,,,print_area='output'!$D$1:$P$97,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
SHEET,,calc,,,calc,false,A1:O31,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
INPUT,INP_000001,data,data!E7,,,,,,ticker_equity,,KWEB US,Underlying ticker,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
INPUT,INP_000002,data,data!E8,,,,,,ticker_option,,KWEB US 03/20/26 C35 Equity,Long leg option symbol,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
INPUT,INP_000003,data,data!E9,,,,,,ticker_option,,KWEB US 03/20/26 C40 Equity,Short leg option symbol,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
INPUT,INP_000004,data,data!E10,,,,,,quantity,,10,Contracts,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
INPUT,INP_000005,data,data!E11,,,,,,other,,Not Rated,Research rating display,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
INPUT,INP_000006,data,data!E12,,,,,,other,,N/A,Target price display,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
BLOOMBERG_FIELD,BBG_000001,data,data!E4,,,,,,,,,BDP destination to be replaced by Python (classification:BDP),"=_xll.BDP(C4,$E$3)",,,,,,,,,,,,,spot_price,market_data,,,,,,,,,,,,,,,,,
BLOOMBERG_FIELD,BBG_000002,data,data!X4,,,,,,,,,BDP destination to be replaced by Python (classification:BDP),"=_xll.BDP(W4,$X$2)",,,,,,,,,,,,,underlying_name,market_data,,,,,,,,,,,,,,,,,
BLOOMBERG_FIELD,BBG_000003,data,data!Y4,,,,,,,,,BDP destination to be replaced by Python (classification:BDP),"=_xll.BDP(W4,$Y$2)",,,,,,,,,,,,,gics_sector_name,market_data,,,,,,,,,,,,,,,,,
BLOOMBERG_FIELD,BBG_000004,output,output!N7,,,,,,,,,BDP destination to be replaced by Python (classification:BDP),"=IF(ISERROR(_xll.BDP(F5&"" equity"",""eqy dvd yld ind"")/100),0,_xll.BDP(F5&"" equity"",""eqy dvd yld ind"")/100)",,,,,,,,,,,,,dividend_yield,market_data,,,,,,,,,,,,,,,,,
BLOOMBERG_FIELD,BBG_000005,output,output!N8,,,,,,,,,BDP destination to be replaced by Python (classification:BDP),"=_xll.BDP(F5&"" equity"",""high 52week"")",,,,,,,,,,,,,high_52w,market_data,,,,,,,,,,,,,,,,,
BLOOMBERG_FIELD,BBG_000006,output,output!N9,,,,,,,,,BDP destination to be replaced by Python (classification:BDP),"=_xll.BDP(F5&"" equity"",""low 52week"")",,,,,,,,,,,,,low_52w,market_data,,,,,,,,,,,,,,,,,
BLOOMBERG_FIELD,BBG_000007,output,output!F9,,,,,,,,,BDP destination to be replaced by Python (classification:BDP),"=_xll.BDP(data!C4,""Chg Pct 1D"")/100",,,,,,,,,,,,,chg_pct_1d,market_data,,,,,,,,,,,,,,,,,
BLOOMBERG_FIELD,BBG_000008,output,output!F10,,,,,,,,,BDP destination to be replaced by Python (classification:BDP),"=_xll.BDP(data!C4,""Chg Net 1D"")",,,,,,,,,,,,,chg_net_1d,market_data,,,,,,,,,,,,,,,,,
BLOOMBERG_FIELD,BBG_000009,output,output!E17,,,,,,,,,BDP destination to be replaced by Python (classification:BDP),"=_xll.BDP(data!E8,""opt delta mid"")",,,,,,,,,,,,,leg1_delta,leg_params,,,,,,,,,,,,,,,,,
BLOOMBERG_FIELD,BBG_000010,output,output!I17,,,,,,,,,BDP destination to be replaced by Python (classification:BDP),"=_xll.BDP(data!E9,""opt delta mid"")*-1",,,,,,,,,,,,,leg2_delta,leg_params,,,,,,,,,,,,,,,,,
BLOOMBERG_FIELD,BBG_000011,output,output!G20,,,,,,,,,BDP destination to be replaced by Python (classification:BDP),"=_xll.BDP(data!$E$8,""opt expire dt"")",,,,,,,,,,,,,leg1_expiry,leg_params,,,,,,,,,,,,,,,,,
BLOOMBERG_FIELD,BBG_000012,output,output!I20,,,,,,,,,BDP destination to be replaced by Python (classification:BDP),"=_xll.BDP(data!$E$8,""opt STRIKE PX"")",,,,,,,,,,,,,leg1_strike,leg_params,,,,,,,,,,,,,,,,,
BLOOMBERG_FIELD,BBG_000013,output,output!J20,,,,,,,,,BDP destination to be replaced by Python (classification:BDP),"=ROUNDUP(_xll.BDP(data!$E$8,""PX MID""),1)",,,,,,,,,,,,,leg1_premium_mid,leg_params,,,,,,,,,,,,,,,,,
BLOOMBERG_FIELD,BBG_000014,output,output!G21,,,,,,,,,BDP destination to be replaced by Python (classification:BDP),"=_xll.BDP(data!$E$9,""opt expire dt"")",,,,,,,,,,,,,leg2_expiry,leg_params,,,,,,,,,,,,,,,,,
BLOOMBERG_FIELD,BBG_000015,output,output!I21,,,,,,,,,BDP destination to be replaced by Python (classification:BDP),"=_xll.BDP(data!$E$9,""OPT STRIKE PX"")",,,,,,,,,,,,,leg2_strike,leg_params,,,,,,,,,,,,,,,,,
BLOOMBERG_FIELD,BBG_000016,output,output!J21,,,,,,,,,BDP destination to be replaced by Python (classification:BDP),"=ROUNDDOWN(_xll.BDP(data!$E$9,""PX MID""),1)",,,,,,,,,,,,,leg2_premium_mid,leg_params,,,,,,,,,,,,,,,,,
CALCULATION,CALC_000001,data,data!I4,,,,,,,,,Volatile calc; prefer Python inject to stabilize,=H4-TODAY(),time,,,,,,,,,,,,days_to_expiry,strategy_metrics,,,,,,,,,,,,,,,,,
CALCULATION,CALC_000002,output,output!N1,,,,,,,,,Volatile calc; prefer Python inject to stabilize,"=TEXT(TODAY(),""dd mmmm yyyy"")",time,,,,,,,,,,,,as_of_date_display,print_meta,,,,,,,,,,,,,,,,,
CALCULATION,CALC_000003,output,output!J60,,,,,,,,,Volatile calc; prefer Python inject to stabilize,"=""* Pricing is HIGHLY indicative on ""&(TEXT(TODAY(),""mmmm dd, yyyy""))",time,,,,,,,,,,,,pricing_disclaimer_date,print_meta,,,,,,,,,,,,,,,,,
CALCULATION,CALC_000004,output,output!O60,,,,,,,,,Volatile calc; prefer Python inject to stabilize,=NOW(),time,,,,,,,,,,,,run_timestamp,print_meta,,,,,,,,,,,,,,,,,
LEAF_OUTPUT,,output,,,,,,,,,,,"=TEXT(TODAY(),""dd mmmm yyyy"")",,,,,OUT_000001,output!N1,print_driver,false,,VolatileFunction,CALC_000002,injections->output_formulas->pdf,,,,,,,,,,,,,,,,,,,
LEAF_OUTPUT,,output,,,,,,,,,,,=data!E7,,,,,OUT_000002,output!F5,value_displayed,false,,data!E7,INP_000001,injections->output_formulas->pdf,,,,,,,,,,,,,,,,,,,
LEAF_OUTPUT,,output,,,,,,,,,,,=data!E11,,,,,OUT_000003,output!N5,value_displayed,false,,data!E11,INP_000005,injections->output_formulas->pdf,,,,,,,,,,,,,,,,,,,
LEAF_OUTPUT,,output,,,,,,,,,,,=data!X4,,,,,OUT_000004,output!F6,value_displayed,false,,data!X4,BBG_000002,injections->output_formulas->pdf,,,,,,,,,,,,,,,,,,,
LEAF_OUTPUT,,output,,,,,,,,,,,=data!E12,,,,,OUT_000005,output!N6,value_displayed,false,,data!E12,INP_000006,injections->output_formulas->pdf,,,,,,,,,,,,,,,,,,,
LEAF_OUTPUT,,output,,,,,,,,,,,"=IF(data!Y4="" #N/A N/A"",""ETF"",data!Y4)",,,,,OUT_000006,output!F7,value_displayed,false,,data!Y4,BBG_000003,injections->output_formulas->pdf,,,,,,,,,,,,,,,,,,,
LEAF_OUTPUT,,output,,,,,,,,,,,"=IF(ISERROR(_xll.BDP(F5&"" equity"",""eqy dvd yld ind"")/100),0,_xll.BDP(F5&"" equity"",""eqy dvd yld ind"")/100)",,,,,OUT_000007,output!N7,text_displayed,false,,output!F5,BBG_000004,injections->output_formulas->pdf,,,,,,,,,,,,,,,,,,,
LEAF_OUTPUT,,output,,,,,,,,,,,=data!E4,,,,,OUT_000008,output!F8,value_displayed,false,,data!E4,BBG_000001,injections->output_formulas->pdf,,,,,,,,,,,,,,,,,,,
LEAF_OUTPUT,,output,,,,,,,,,,,"=_xll.BDP(F5&"" equity"",""high 52week"")",,,,,OUT_000009,output!N8,text_displayed,false,,output!F5,BBG_000005,injections->output_formulas->pdf,,,,,,,,,,,,,,,,,,,
LEAF_OUTPUT,,output,,,,,,,,,,,"=_xll.BDP(data!C4,""Chg Pct 1D"")/100",,,,,OUT_000010,output!F9,value_displayed,false,,data!C4,BBG_000007,injections->output_formulas->pdf,,,,,,,,,,,,,,,,,,,
LEAF_OUTPUT,,output,,,,,,,,,,,"=_xll.BDP(F5&"" equity"",""low 52week"")",,,,,OUT_000011,output!N9,text_displayed,false,,output!F5,BBG_000006,injections->output_formulas->pdf,,,,,,,,,,,,,,,,,,,
LEAF_OUTPUT,,output,,,,,,,,,,,"=_xll.BDP(data!C4,""Chg Net 1D"")",,,,,OUT_000012,output!F10,value_displayed,false,,data!C4,BBG_000008,injections->output_formulas->pdf,,,,,,,,,,,,,,,,,,,
LEAF_OUTPUT,,output,,,,,,,,,,,=(E15*100)*F20,,,,,OUT_000013,output!N11,value_displayed,false,,output!E15;output!F20,BBG_000012;INP_000004,injections->output_formulas->pdf,,,,,,,,,,,,,,,,,,,
LEAF_OUTPUT,,output,,,,,,,,,,,=F5,,,,,OUT_000014,output!E13,value_displayed,false,,output!F5,INP_000001,injections->output_formulas->pdf,,,,,,,,,,,,,,,,,,,
LEAF_OUTPUT,,output,,,,,,,,,,,=F5,,,,,OUT_000015,output!I13,value_displayed,false,,output!F5,INP_000001,injections->output_formulas->pdf,,,,,,,,,,,,,,,,,,,
LEAF_OUTPUT,,output,,,,,,,,,,,=E15,,,,,OUT_000016,output!N13,value_displayed,false,,output!E15,BBG_000012,injections->output_formulas->pdf,,,,,,,,,,,,,,,,,,,
LEAF_OUTPUT,,output,,,,,,,,,,,=G20,,,,,OUT_000017,output!E14,value_displayed,false,,output!G20,BBG_000011,injections->output_formulas->pdf,,,,,,,,,,,,,,,,,,,
LEAF_OUTPUT,,output,,,,,,,,,,,=G21,,,,,OUT_000018,output!I14,value_displayed,false,,output!G21,BBG_000014,injections->output_formulas->pdf,,,,,,,,,,,,,,,,,,,
LEAF_OUTPUT,,output,,,,,,,,,,,=I15,,,,,OUT_000019,output!N14,value_displayed,false,,output!I15,BBG_000015,injections->output_formulas->pdf,,,,,,,,,,,,,,,,,,,
LEAF_OUTPUT,,output,,,,,,,,,,,=I20,,,,,OUT_000020,output!E15,value_displayed,false,,output!I20,BBG_000012,injections->output_formulas->pdf,,,,,,,,,,,,,,,,,,,
LEAF_OUTPUT,,output,,,,,,,,,,,=I21,,,,,OUT_000021,output!I15,value_displayed,false,,output!I21,BBG_000015,injections->output_formulas->pdf,,,,,,,,,,,,,,,,,,,
LEAF_OUTPUT,,output,,,,,,,,,,,=N14-N13,,,,,OUT_000022,output!N15,value_displayed,false,,output!N13;output!N14,BBG_000012;BBG_000015,injections->output_formulas->pdf,,,,,,,,,,,,,,,,,,,
LEAF_OUTPUT,,output,,,,,,,,,,,=J20,,,,,OUT_000023,output!E16,value_displayed,false,,output!J20,BBG_000013,injections->output_formulas->pdf,,,,,,,,,,,,,,,,,,,
LEAF_OUTPUT,,output,,,,,,,,,,,=J21,,,,,OUT_000024,output!I16,value_displayed,false,,output!J21,BBG_000016,injections->output_formulas->pdf,,,,,,,,,,,,,,,,,,,
LEAF_OUTPUT,,output,,,,,,,,,,,=K20,,,,,OUT_000025,output!N16,value_displayed,false,,output!K20,BBG_000013;BBG_000016,injections->output_formulas->pdf,,,,,,,,,,,,,,,,,,,
LEAF_OUTPUT,,output,,,,,,,,,,,"=_xll.BDP(data!E8,""opt delta mid"")",,,,,OUT_000026,output!E17,value_displayed,false,,data!E8,BBG_000009,injections->output_formulas->pdf,,,,,,,,,,,,,,,,,,,
LEAF_OUTPUT,,output,,,,,,,,,,,"=_xll.BDP(data!E9,""opt delta mid"")*-1",,,,,OUT_000027,output!I17,value_displayed,false,,data!E9,BBG_000010,injections->output_formulas->pdf,,,,,,,,,,,,,,,,,,,
LEAF_OUTPUT,,output,,,,,,,,,,,=N15+N16,,,,,OUT_000028,output!N17,value_displayed,false,,output!N15;output!N16,BBG_000012;BBG_000013;BBG_000015;BBG_000016,injections->output_formulas->pdf,,,,,,,,,,,,,,,,,,,
LEAF_OUTPUT,,output,,,,,,,,,,,=(N17*-1)/N16,,,,,OUT_000029,output!O17,value_displayed,false,,output!N16;output!N17,BBG_000012;BBG_000013;BBG_000015;BBG_000016,injections->output_formulas->pdf,,,,,,,,,,,,,,,,,,,
LEAF_OUTPUT,,output,,,,,,,,,,,=data!I4,,,,,OUT_000030,output!H18,value_displayed,false,,data!I4,CALC_000001,injections->output_formulas->pdf,,,,,,,,,,,,,,,,,,,
LEAF_OUTPUT,,output,,,,,,,,,,,=F5,,,,,OUT_000031,output!D20,value_displayed,false,,output!F5,INP_000001,injections->output_formulas->pdf,,,,,,,,,,,,,,,,,,,
LEAF_OUTPUT,,output,,,,,,,,,,,=data!E10,,,,,OUT_000032,output!F20,value_displayed,false,,data!E10,INP_000004,injections->output_formulas->pdf,,,,,,,,,,,,,,,,,,,
LEAF_OUTPUT,,output,,,,,,,,,,,"=_xll.BDP(data!$E$8,""opt expire dt"")",,,,,OUT_000033,output!G20,value_displayed,false,,data!E8,BBG_000011,injections->output_formulas->pdf,,,,,,,,,,,,,,,,,,,
LEAF_OUTPUT,,output,,,,,,,,,,,"=_xll.BDP(data!$E$8,""opt STRIKE PX"")",,,,,OUT_000034,output!I20,value_displayed,false,,data!E8,BBG_000012,injections->output_formulas->pdf,,,,,,,,,,,,,,,,,,,
LEAF_OUTPUT,,output,,,,,,,,,,,"=ROUNDUP(_xll.BDP(data!$E$8,""PX MID""),1)",,,,,OUT_000035,output!J20,value_displayed,false,,data!E8,BBG_000013,injections->output_formulas->pdf,,,,,,,,,,,,,,,,,,,
LEAF_OUTPUT,,output,,,,,,,,,,,=J21-J20,,,,,OUT_000036,output!K20,value_displayed,false,,output!J20;output!J21,BBG_000013;BBG_000016,injections->output_formulas->pdf,,,,,,,,,,,,,,,,,,,
LEAF_OUTPUT,,output,,,,,,,,,,,=I20+(K20*-1),,,,,OUT_000037,output!M20,value_displayed,false,,output!I20;output!K20,BBG_000012;BBG_000013;BBG_000016,injections->output_formulas->pdf,,,,,,,,,,,,,,,,,,,
LEAF_OUTPUT,,output,,,,,,,,,,,=F20*100*J20*-1,,,,,OUT_000038,output!N20,value_displayed,false,,output!F20;output!J20,BBG_000013;INP_000004,injections->output_formulas->pdf,,,,,,,,,,,,,,,,,,,
LEAF_OUTPUT,,output,,,,,,,,,,,=F5,,,,,OUT_000039,output!D21,value_displayed,false,,output!F5,INP_000001,injections->output_formulas->pdf,,,,,,,,,,,,,,,,,,,
LEAF_OUTPUT,,output,,,,,,,,,,,=F20,,,,,OUT_000040,output!F21,value_displayed,false,,output!F20,INP_000004,injections->output_formulas->pdf,,,,,,,,,,,,,,,,,,,
LEAF_OUTPUT,,output,,,,,,,,,,,"=_xll.BDP(data!$E$9,""opt expire dt"")",,,,,OUT_000041,output!G21,value_displayed,false,,data!E9,BBG_000014,injections->output_formulas->pdf,,,,,,,,,,,,,,,,,,,
LEAF_OUTPUT,,output,,,,,,,,,,,"=_xll.BDP(data!$E$9,""OPT STRIKE PX"")",,,,,OUT_000042,output!I21,value_displayed,false,,data!E9,BBG_000015,injections->output_formulas->pdf,,,,,,,,,,,,,,,,,,,
LEAF_OUTPUT,,output,,,,,,,,,,,"=ROUNDDOWN(_xll.BDP(data!$E$9,""PX MID""),1)",,,,,OUT_000043,output!J21,value_displayed,false,,data!E9,BBG_000016,injections->output_formulas->pdf,,,,,,,,,,,,,,,,,,,
LEAF_OUTPUT,,output,,,,,,,,,,,=F21*100*J21,,,,,OUT_000044,output!N21,value_displayed,false,,output!F21;output!J21,BBG_000016;INP_000004,injections->output_formulas->pdf,,,,,,,,,,,,,,,,,,,
LEAF_OUTPUT,,output,,,,,,,,,,,=SUM(N20:P21),,,,,OUT_000045,output!N22,value_displayed,false,,output!N20;output!N21;output!O20;output!O21;output!P20;output!P21,BBG_000013;BBG_000016;INP_000004,injections->output_formulas->pdf,,,,,,,,,,,,,,,,,,,
LEAF_OUTPUT,,output,,,,,,,,,,,=(F8-I20)*F20*100,,,,,OUT_000046,output!E23,value_displayed,false,,output!F20;output!F8;output!I20,BBG_000001;BBG_000012;INP_000004,injections->output_formulas->pdf,,,,,,,,,,,,,,,,,,,
LEAF_OUTPUT,,output,,,,,,,,,,,"=""Max Net Profit if ""&F6&"" is above the short ""&I15&"" strike at expiration or ""&TEXT(E26,""0.00%"")&"" above the underlying price of ""&TEXT(F8,""$0.00"")&""""",,,,,OUT_000047,output!F23,text_displayed,false,,output!E26;output!F6;output!F8;output!I15,BBG_000001;BBG_000002;BBG_000015,injections->output_formulas->pdf,,,,,,,,,,,,,,,,,,,
LEAF_OUTPUT,,output,,,,,,,,,,,=(N17*F20)*100,,,,,OUT_000048,output!N23,value_displayed,false,,output!F20;output!N17,BBG_000012;BBG_000013;BBG_000015;BBG_000016;INP_000004,injections->output_formulas->pdf,,,,,,,,,,,,,,,,,,,
LEAF_OUTPUT,,output,,,,,,,,,,,=(F8-E15)*F20*100,,,,,OUT_000049,output!N24,value_displayed,false,,output!E15;output!F20;output!F8,BBG_000001;BBG_000012;INP_000004,injections->output_formulas->pdf,,,,,,,,,,,,,,,,,,,
LEAF_OUTPUT,,output,,,,,,,,,,,=N22+N24,,,,,OUT_000050,output!N25,value_displayed,false,,output!N22;output!N24,BBG_000001;BBG_000012;BBG_000013;BBG_000016;INP_000004,injections->output_formulas->pdf,,,,,,,,,,,,,,,,,,,
LEAF_OUTPUT,,output,,,,,,,,,,,=(F8-I20)*(F20*100)+N22,,,,,OUT_000051,output!D26,value_displayed,false,,output!F20;output!F8;output!I20;output!N22,BBG_000001;BBG_000012;BBG_000013;BBG_000016;INP_000004,injections->output_formulas->pdf,,,,,,,,,,,,,,,,,,,
LEAF_OUTPUT,,output,,,,,,,,,,,=(I21-F8)/F8,,,,,OUT_000052,output!E26,value_displayed,false,,output!F8;output!I21,BBG_000001;BBG_000015,injections->output_formulas->pdf,,,,,,,,,,,,,,,,,,,
LEAF_OUTPUT,,output,,,,,,,,,,,"=""Net spread gain / (loss) if ""&F6&"" is unchanged at expiration or trading at ""&TEXT(F8, ""$0.00"")&"" or intrinsic value of ""&TEXT(E23,""$0,0"")&"" and the short call expires worthless""",,,,,OUT_000053,output!F26,text_displayed,false,,output!E23;output!F6;output!F8,BBG_000001;BBG_000002;BBG_000012;INP_000004,injections->output_formulas->pdf,,,,,,,,,,,,,,,,,,,
LEAF_OUTPUT,,output,,,,,,,,,,,=D26,,,,,OUT_000054,output!N26,value_displayed,false,,output!D26,BBG_000001;BBG_000012;BBG_000013;BBG_000016;INP_000004,injections->output_formulas->pdf,,,,,,,,,,,,,,,,,,,
LEAF_OUTPUT,,output,,,,,,,,,,,"=""Net spread value if ""&F6&"" is unchanged at expiration """,,,,,OUT_000055,output!G27,text_displayed,false,,output!F6,BBG_000002,injections->output_formulas->pdf,,,,,,,,,,,,,,,,,,,
LEAF_OUTPUT,,output,,,,,,,,,,,=(F8-E15)*F20*100,,,,,OUT_000056,output!N27,value_displayed,false,,output!E15;output!F20;output!F8,BBG_000001;BBG_000012;INP_000004,injections->output_formulas->pdf,,,,,,,,,,,,,,,,,,,
LEAF_OUTPUT,,output,,,,,,,,,,,"=""In this example, ""&F6&"" ""&E14&"" ""&E15&"" strike calls are purchased at ""&TEXT(E16,""$0.00"")&"" and ""&F21&"" ""&F6&"" ""&I14&"" ""&I15&"" Strike calls are sold at ""&TEXT(I16,""$0.00"")&"" for a net debit of ""&TEXT(K20*-1,""$0.00"")&"" resulting in a net trade cost of ""&TEXT(N22*-1,""$#,##0.00"")&"". Upside participation on the ""&F6&"" ""&E14&"" ""&E15&"" Strike call is limited to the short call strike of ""&I15&"". If ""&F6&"" is above ""&I15&"" at ""&I14&"" expiration, the strategy will result in a max net spread value of ""&TEXT(((I15-M20)*F20*100),""$#,##0.00"")&"" or a ""&TEXT(((I15-M20)*F20*100)/(N22*-1),""0.0%"")&"" gain. If ""&F6&"" is trading between ""&E15&"" and ""&I15&"" at ""&I14&"" expiration, the short call will expire worthless and the investor can either sell the long options or exercise/purchase ""&F6&"" stock at ""&TEXT(E15,""$0.00"")&"". Finally, if ""&F6&"" is trading below ""&E15&"" at option expiration or drops ""&TEXT(Q46,""0.00%"")&"", the investor will lose the initial investment of ""&TEXT(K20*-1,""$0.00"")&"" or ""&TEXT(N22,""$#,###0.00"")&"" for ""&F20&"" contracts.""",,,,,OUT_000057,output!D29,text_displayed,false,,output!E14;output!E15;output!E16;output!F20;output!F21;output!F6;output!I14;output!I15;…,BBG_000001;BBG_000002;BBG_000011;BBG_000012;BBG_000013;BBG_000014;BBG_000015;BBG_000016;INP_000004,injections->output_formulas->pdf,,,,,,,,,,,,,,,,,,,
LEAF_OUTPUT,,output,,,,,,,,,,,"=""* Pricing is HIGHLY indicative on ""&(TEXT(TODAY(),""mmmm dd, yyyy""))",,,,,OUT_000058,output!J60,print_driver,false,,VolatileFunction,CALC_000003,injections->output_formulas->pdf,,,,,,,,,,,,,,,,,,,
LEAF_OUTPUT,,output,,,,,,,,,,,=NOW(),,,,,OUT_000059,output!O60,print_driver,false,,VolatileFunction,CALC_000004,injections->output_formulas->pdf,,,,,,,,,,,,,,,,,,,
LEAF_OUTPUT,,Graph,,,,,,,,,,,,,,,,OUT_999900,Graph!A3:D26,chart_visible_source,false,,Graph formulas -> external links [n]Data,,INJ_000013 -> chart series,,,,,,,,,,,,,,,,,,,
PYTHON_INJECTION,,data,,,,,,,,,,Contiguous input block used to build tickers/labels; drives most template fields (E7 underlying; E8 long opt; E9 short opt; E10 contracts; E11 rating; E12 target).,,,,,,,,,,,,,,strategy_inputs_block,leg_params,array_1d,INJ_000001,data!E7:E12,P0,OUT_000002;OUT_000003;OUT_000005;OUT_000013;OUT_000014;OUT_000015;OUT_000031;OUT_000032;OUT_000038;OUT_000039;OUT_000040;OUT_000044;OUT_000045;OUT_000046;OUT_000048;OUT_000049;OUT_000050;OUT_000051;OUT_000053;OUT_000054;OUT_000056;OUT_000057,output!F5;output!N5;output!N6;output!N11;output!E13;output!I13;output!D20;output!F20;output!N20;output!D21;output!F21;output!N21;output!N22;output!E23;output!N23;output!N24;output!N25;output!D26;output!F26;output!N26;output!N27;output!D29,,,,,,,,,,,
PYTHON_INJECTION,,data,,,,,,,,,,Replace Bloomberg spot price staging cell referenced by template (data!E4).,,,,,,,,,,,,,,spot_price,market_data,number,INJ_000002,data!E4,P0,OUT_000008;OUT_000046;OUT_000047;OUT_000049;OUT_000050;OUT_000051;OUT_000052;OUT_000053;OUT_000054;OUT_000056;OUT_000057,output!F8;output!E23;output!F23;output!N24;output!N25;output!D26;output!E26;output!F26;output!N26;output!N27;output!D29,,,,,,,,,,,
PYTHON_INJECTION,,data,,,,,,,,,,Replace volatile DTE calc (data!I4) so downstream metrics stay stable.,,,,,,,,,,,,,,days_to_expiry,strategy_metrics,number,INJ_000003,data!I4,P0,OUT_000030,output!H18,,,,,,,,,,,
PYTHON_INJECTION,,data,,,,,,,,,,Replace Bloomberg name/sector staging cells referenced by template (data!X4:Y4).,,,,,,,,,,,,,,underlying_name_sector,market_data,array_1d,INJ_000004,data!X4:Y4,P0,OUT_000004;OUT_000006;OUT_000047;OUT_000053;OUT_000055;OUT_000057,output!F6;output!F7;output!F23;output!F26;output!G27;output!D29,,,,,,,,,,,
PYTHON_INJECTION,,output,,,,,,,,,,Output sheet contains direct Bloomberg calls for yield/52w (output!N7:N9); overwrite to remove add-in dependency.,,,,,,,,,,,,,,underlying_yield_high_low_52w,market_data,array_1d,INJ_000005,output!N7:N9,P0,OUT_000007;OUT_000009;OUT_000011,output!N7;output!N8;output!N9,,,,,,,,,,,
PYTHON_INJECTION,,output,,,,,,,,,,Output sheet contains direct Bloomberg calls for day change (output!F9:F10); overwrite to remove add-in dependency.,,,,,,,,,,,,,,day_change_pct_net,market_data,array_1d,INJ_000006,output!F9:F10,P0,OUT_000010;OUT_000012,output!F9;output!F10,,,,,,,,,,,
PYTHON_INJECTION,,output,,,,,,,,,,"Option deltas pulled via Bloomberg in output (E17,I17); overwrite with engine values (range includes blanks).",,,,,,,,,,,,,,option_deltas_long_short,leg_params,array_1d,INJ_000007,output!E17:I17,P0,OUT_000026;OUT_000027,output!E17;output!I17,,,,,,,,,,,
PYTHON_INJECTION,,output,,,,,,,,,,Option expiry/strike/premiums pulled via Bloomberg in output grid; overwrite with engine 2x4 term grid (G20:J21).,,,,,,,,,,,,,,option_leg_term_grid,leg_params,array_2d,INJ_000008,output!G20:J21,P0,OUT_000013;OUT_000016;OUT_000017;OUT_000018;OUT_000019;OUT_000020;OUT_000021;OUT_000022;OUT_000023;OUT_000024;OUT_000025;OUT_000028;OUT_000029;OUT_000033;OUT_000034;OUT_000035;OUT_000036;OUT_000037;OUT_000038;OUT_000041;OUT_000042;OUT_000043;OUT_000044;OUT_000045;OUT_000046;OUT_000047;OUT_000048;OUT_000049;OUT_000050;OUT_000051;OUT_000052;OUT_000053;OUT_000054;OUT_000056;OUT_000057,output!N11;output!N13;output!E14;output!I14;output!N14;output!E15;output!I15;output!N15;output!E16;output!I16;output!N16;output!N17;output!O17;output!G20;output!I20;output!J20;output!K20;output!M20;output!N20;output!G21;output!I21;output!J21;output!N21;output!N22;output!E23;output!F23;output!N23;output!N24;output!N25;output!D26;output!E26;output!F26;output!N26;output!N27;output!D29,,,,,,,,,,,
PYTHON_INJECTION,,output,,,,,,,,,,Replace TODAY()-formatted date for deterministic PDF stamping (output!N1).,,,,,,,,,,,,,,as_of_date_display,print_meta,text,INJ_000009,output!N1,P1,OUT_000001,output!N1,,,,,,,,,,,
PYTHON_INJECTION,,output,,,,,,,,,,Replace pricing footnote date string (output!J60) (uses TODAY()).,,,,,,,,,,,,,,pricing_disclaimer_date,print_meta,text,INJ_000010,output!J60,P1,OUT_000058,output!J60,,,,,,,,,,,
PYTHON_INJECTION,,output,,,,,,,,,,Replace NOW() timestamp if included in print/export (output!O60).,,,,,,,,,,,,,,run_timestamp,print_meta,date,INJ_000011,output!O60,P2,OUT_000059,output!O60,,,,,,,,,,,
PYTHON_INJECTION,,Graph,,,,,,,,,,Remove external link for chart header label cell (Graph!A3).,,,,,,,,,,,,,,payoff_chart_x_label,chart_series,text,INJ_000012,Graph!A3,P1,OUT_999900,Graph!A3:D26,,,,,,,,,,,
PYTHON_INJECTION,,Graph,,,,,,,,,,Replace external-linked payoff curve table feeding payoff diagram (Graph!A4:D26).,,,,,,,,,,,,,,payoff_curve_table,payoff_curve,array_2d,INJ_000013,Graph!A4:D26,P1,OUT_999900,Graph!A3:D26,,,,,,,,,,,
LEGS_SUMMARY,,data,,,,,,,,,,Detected by Inputs section (Long/Short option symbols).,,,,,,,,,,,,,,,,,,,,,,2,data!D8:E9,,,,,,,,,
LEG_FIELD,,,,,,,,,,,,Long,,,,,,,,,,,,,,,,,,,,,,,,1,data!D8,data!D8,output!I20,output!G20,output!J20,output!E17,,
LEG_FIELD,,,,,,,,,,,,Short,,,,,,,,,,,,,,,,,,,,,,,,2,data!D9,data!D9,output!I21,output!G21,output!J21,output!I17,,
FLAG,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,VOLATILE_FUNCTION,count=6;cells=data!A2;data!I4;data!J4;output!J60;output!N1;output!O60
FLAG,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,EXTERNAL_LINK,externalLinksPart=True;example_cells=Graph!A10;Graph!A11;Graph!A12;Graph!A13;Graph!A14;Graph!A15;Graph!A16;Graph!A17;Graph!A18;Graph!A19;Graph!A20;Graph!A21;Graph!A22;Graph!A23;Graph!A24;Graph!A25;Graph!A26;Graph!A3;Graph!A4;Graph!A5;Graph!A6;Graph!A7;Graph!A8;Graph!A9;Graph!B10;Graph!B11;Graph!B12;Graph!B13;Graph!B14;Graph!B15;Graph!B16;Graph!B17;Graph!B18;Graph!B19;Graph!B2;Graph!B20;Graph!B21;Graph!B22;Graph!B23;Graph!B24;Graph!B25;Graph!B26;Graph!B4;Graph!B5;Graph!B6;Graph!B7;Graph!B8;Graph!B9;Graph!C10;Graph!C11;Graph!C12;Graph!C13;Graph!C14;Graph!C15;Graph!C16;Graph!C17;Graph!C18;Graph!C19;Graph!C20;Graph!C21;Graph!C22;Graph!C23;Graph!C24;Graph!C25;Graph!C26;Graph!C4;Graph!C5;Graph!C6;Graph!C7;Graph!C8;Graph!C9;Graph!D10;Graph!D11;Graph!D12;Graph!D13;Graph!D14;Graph!D15;Graph!D16;Graph!D17;Graph!D18;Graph!D19;Graph!D20;Graph!D21;Graph!D22;Graph!D23;Graph!D24;Graph!D25;Graph!D26;Graph!D4;Graph!D5;Graph!D6;Graph!D7;Graph!D8;Graph!D9;mitigation=overwrite Graph!A3:D26 and any [n] refs via injection

Single Stock - Protective Collar:
record_type,id,sheet_name,cell,range,sheet_role,hidden,used_range,label_cell,input_type,validation,default_value,notes,formula_text,calc_category,procedural_steps,dependencies,outputs_to,output_id,output_cell,output_type,is_static,static_text,immediate_source,root_dependencies,lineage_summary,engine_key,engine_output_category,expected_datatype,injection_id,injection_cell_or_range,injection_priority,drives_output_ids,drives_output_cells,legs_detected,legs_table_ranges,leg_index,leg_position_cell,leg_type_cell,leg_strike_cell,leg_expiry_cell,leg_premium_cell,leg_delta_cell,flag_type,flag_details
WORKBOOK_METADATA,,,,,,,,,,,,"{""file_name"":""Single Stock_Protective Collar.xlsx"",""has_macros_detected"":false,""named_ranges_detected"":true,""external_links_detected"":true,""circular_references_detected"":false} citeturn1search1turn1search2",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
SHEET,,DIV,,,data,True,A1:A1,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
SHEET,,data,,,data,False,A1:AC357,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
SHEET,,Protective Collar,,,output,False,C1:R61,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
SHEET,,COMMISSION CALC,,,calc,False,A1:L31,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
INPUT,INP_000001,data,data!E7,,,,,data!D7,ticker_equity,,MSFT US,,,,,,,,,,,,,,,underlying_ticker,,,,,,,,,,,,,,,,,,
INPUT,INP_000002,data,data!E8,,,,,data!D8,ticker_option,,<leg1_option_symbol>,,,,,,,,,,,,,,,leg1_option_symbol,,,,,,,,,,,,,,,,,,
INPUT,INP_000003,data,data!E9,,,,,data!D9,ticker_option,,<leg2_option_symbol>,,,,,,,,,,,,,,,leg2_option_symbol,,,,,,,,,,,,,,,,,,
INPUT,INP_000004,data,data!E10,,,,,data!D10,quantity_contracts,,10,,,,,,,,,,,,,,,contracts,,,,,,,,,,,,,,,,,,
INPUT,INP_000005,data,data!E11,,,,,data!D11,other,,Neutral,,,,,,,,,,,,,,,grp_research_rating,,,,,,,,,,,,,,,,,,
INPUT,INP_000006,data,data!E12,,,,,data!D12,other,,500,,,,,,,,,,,,,,,grp_research_target,,,,,,,,,,,,,,,,,,
INPUT,INP_000007,data,data!E13,,,,,data!D13,other,,Not Rated,,,,,,,,,,,,,,,cio_rating,,,,,,,,,,,,,,,,,,
BLOOMBERG_FIELD,BBG_000001,,data!E4:O5,,,,,,,,,BDP staging grid (spot/legs/vols) -> overwritten by INJ_000002,BDP,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
BLOOMBERG_FIELD,BBG_000002,,data!X4:Y4,,,,,,,,,BDP name/sector -> overwritten by INJ_000004,BDP,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
BLOOMBERG_FIELD,BBG_000003,,Protective Collar!O4,,,,,,,,,BDP expected report dt -> overwritten by INJ_000005,BDP,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
BLOOMBERG_FIELD,BBG_000004,,Protective Collar!O7:O9,,,,,,,,,BDP dvd yld + 52w hi/low -> overwritten by INJ_000006,BDP,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
BLOOMBERG_FIELD,BBG_000005,,Protective Collar!F9:F10,,,,,,,,,BDP 1D chg pct/net -> overwritten by INJ_000007,BDP,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
BLOOMBERG_FIELD,BBG_000006,,Protective Collar!G14:G15,,,,,,,,,BDP leg2 expiry/strike -> overwritten by INJ_000008,BDP,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
BLOOMBERG_FIELD,BBG_000007,,Protective Collar!F17:G18,,,,,,,,,BDP premiums/deltas -> overwritten by INJ_000009,BDP,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
CALCULATION,CALC_000001,,Protective Collar!M16:O20,,,,,,,,,,net_credit/breakeven/max_upside etc,strategy_metrics,compute_net_credit|compute_breakeven|compute_effective_sale_px|compute_max_upside,INP_000004;BBG_000001;BBG_000006;BBG_000007,OUT_000003;OUT_000004;OUT_000006;OUT_000009,,,,,,,,,,,,,,,,,,,,,,,,,,,
CALCULATION,CALC_000002,,Protective Collar!D24:F32,,,,,,,,,,concatenated narratives,narrative_text,assemble_strings,CALC_000001;INP_000001,OUT_000005;OUT_000007;OUT_000008,,,,,,,,,,,,,,,,,,,,,,,,,,,
CALCULATION,CALC_000003,,"Protective Collar!N1,H60,L60",,,,,,,,,,TODAY/NOW footer+header,print_meta,format_display_date|format_footer_date_time,,OUT_000001;OUT_000010,,,,,,,,,,,,,,,,,,,,,,,,,,,
LEAF_OUTPUT,,,,,,,,,,,,,,,,,,OUT_000001,Protective Collar!N1,text_displayed,FALSE,,pricing date banner,CALC_000003,INJ_000010 -> OUT,,,,,,,,,,,,,,,,,,,
LEAF_OUTPUT,,,,,,,,,,,,,,,,,,OUT_000002,Protective Collar!F5:O12,value_displayed,FALSE,,stock details block,INP_000001;INP_000005;INP_000006;INP_000007;BBG_000001;BBG_000002;BBG_000003;BBG_000004;BBG_000005,INJ_000001/2/4-7 -> OUT,,,,,,,,,,,,,,,,,,,
LEAF_OUTPUT,,,,,,,,,,,,,,,,,,OUT_000003,Protective Collar!F14:O20,value_displayed,FALSE,,trade details + metrics,INP_000002;INP_000003;INP_000004;BBG_000001;BBG_000006;BBG_000007,INJ_000001/2/3/8/9 -> OUT,,,,,,,,,,,,,,,,,,,
LEAF_OUTPUT,,,,,,,,,,,,,,,,,,OUT_000004,Protective Collar!Q23:R23,text_displayed,FALSE,,max appreciation statement,CALC_000001,metrics -> statement,,,,,,,,,,,,,,,,,,,
LEAF_OUTPUT,,,,,,,,,,,,,,,,,,OUT_000005,Protective Collar!D24:F24,text_displayed,FALSE,,above-strike narrative,CALC_000002,metrics -> narrative,,,,,,,,,,,,,,,,,,,
LEAF_OUTPUT,,,,,,,,,,,,,,,,,,OUT_000006,Protective Collar!Q24:Q25,text_displayed,FALSE,,max decline + current px,CALC_000001,metrics -> statement,,,,,,,,,,,,,,,,,,,
LEAF_OUTPUT,,,,,,,,,,,,,,,,,,OUT_000007,Protective Collar!D28:F28,text_displayed,FALSE,,between-strikes narrative,CALC_000002,metrics -> narrative,,,,,,,,,,,,,,,,,,,
LEAF_OUTPUT,,,,,,,,,,,,,,,,,,OUT_000008,Protective Collar!D32:F32,text_displayed,FALSE,,below-strike narrative,CALC_000002,metrics -> narrative,,,,,,,,,,,,,,,,,,,
LEAF_OUTPUT,,,,,,,,,,,,,,,,,,OUT_000009,Protective Collar!Q32:Q34,text_displayed,FALSE,,breakeven/strike labels,CALC_000001,metrics -> labels,,,,,,,,,,,,,,,,,,,
LEAF_OUTPUT,,,,,,,,,,,,,,,,,,OUT_000010,Protective Collar!H60:L60,print_driver,FALSE,,timestamp + pricing line,CALC_000003,INJ_000011/12 -> OUT,,,,,,,,,,,,,,,,,,,
LEGS_SUMMARY,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,2,data!D8:E9;Protective Collar!F14:G18,,,,,,,,,
LEG_FIELD,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,1,,data!E8,Protective Collar!F15,Protective Collar!F14,Protective Collar!F17,Protective Collar!F18,,
LEG_FIELD,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,2,,data!E9,Protective Collar!G15,Protective Collar!G14,Protective Collar!G17,Protective Collar!G18,,
PYTHON_INJECTION,,,,,,,,,,,,,,,,,,,,,,,,,,inputs_block,leg_params,array_1d,INJ_000001,data!E7:E13,P0,OUT_000002;OUT_000003,Protective Collar!F5:O12;Protective Collar!F14:O20,,,,,,,,,,,
PYTHON_INJECTION,,,,,,,,,,,,,,,,,,,,,,,,,,market_leg_staging_table,market_data,array_2d,INJ_000002,data!E4:O5,P0,OUT_000002;OUT_000003,Protective Collar!F8;Protective Collar!F14:F16;Protective Collar!F15;Protective Collar!F16;Protective Collar!G20,,,,,,,,,,,
PYTHON_INJECTION,,,,,,,,,,,,,,,,,,,,,,,,,,projected_dividends_per_share_to_expiry,strategy_metrics,number,INJ_000003,data!T4,P0,OUT_000003,Protective Collar!G20,,,,,,,,,,,
PYTHON_INJECTION,,,,,,,,,,,,,,,,,,,,,,,,,,underlying_name_and_sector,market_data,array_1d,INJ_000004,data!X4:Y4,P0,OUT_000002,Protective Collar!F6;Protective Collar!F7,,,,,,,,,,,
PYTHON_INJECTION,,,,,,,,,,,,,,,,,,,,,,,,,,earnings_date,market_data,date,INJ_000005,Protective Collar!O4,P0,OUT_000002,Protective Collar!O4,,,,,,,,,,,
PYTHON_INJECTION,,,,,,,,,,,,,,,,,,,,,,,,,,div_yield_and_52w_range,market_data,array_1d,INJ_000006,Protective Collar!O7:O9,P0,OUT_000002,Protective Collar!O7:O9,,,,,,,,,,,
PYTHON_INJECTION,,,,,,,,,,,,,,,,,,,,,,,,,,day_change_metrics,market_data,array_1d,INJ_000007,Protective Collar!F9:F10,P0,OUT_000002,Protective Collar!F9:F10,,,,,,,,,,,
PYTHON_INJECTION,,,,,,,,,,,,,,,,,,,,,,,,,,leg2_expiry_and_strike,leg_params,array_1d,INJ_000008,Protective Collar!G14:G15,P0,OUT_000003,Protective Collar!G14:G15,,,,,,,,,,,
PYTHON_INJECTION,,,,,,,,,,,,,,,,,,,,,,,,,,leg_premiums_and_deltas,leg_params,array_2d,INJ_000009,Protective Collar!F17:G18,P0,OUT_000003,Protective Collar!F17:G18,,,,,,,,,,,
PYTHON_INJECTION,,,,,,,,,,,,,,,,,,,,,,,,,,pricing_date_display,print_meta,text,INJ_000010,Protective Collar!N1,P1,OUT_000001,Protective Collar!N1,,,,,,,,,,,
PYTHON_INJECTION,,,,,,,,,,,,,,,,,,,,,,,,,,pricing_timestamp,print_meta,date,INJ_000011,Protective Collar!H60,P1,OUT_000010,Protective Collar!H60,,,,,,,,,,,
PYTHON_INJECTION,,,,,,,,,,,,,,,,,,,,,,,,,,pricing_indicative_line,print_meta,text,INJ_000012,Protective Collar!L60,P1,OUT_000010,Protective Collar!L60,,,,,,,,,,,
FLAG,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,VOLATILE_FUNCTION,"TODAY/NOW present in data!A2,I4,J4 and Protective Collar!N1,F19,G19,H60,L60; overwrite volatile outputs via INJ_000002 and INJ_000010-12"
FLAG,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,EXTERNAL_LINK,"data!U4 formula contains ""[1]output! #REF!"" (broken external-style ref); not on output path but should be cleared or replaced"
FLAG,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,NAMED_RANGE_DETECTED,"named ranges: expire, EXPIRES (not referenced in Protective Collar formulas)"

Single Stock - Put Sread Hedge:
record_type,id,sheet_name,cell,range,sheet_role,hidden,used_range,label_cell,input_type,validation,default_value,notes,formula_text,calc_category,procedural_steps,dependencies,outputs_to,output_id,output_cell,output_type,is_static,static_text,immediate_source,root_dependencies,lineage_summary,engine_key,engine_output_category,expected_datatype,injection_id,injection_cell_or_range,injection_priority,drives_output_ids,drives_output_cells,legs_detected,legs_table_ranges,leg_index,leg_position_cell,leg_type_cell,leg_strike_cell,leg_expiry_cell,leg_premium_cell,leg_delta_cell,flag_type,flag_details
WORKBOOK_METADATA,,,,,,,,,,,,"{""file_name"":""Single Stock_Put Spread Hedge.xlsx"",""has_macros_detected"":false,""named_ranges_detected"":true,""external_links_detected"":true,""circular_references_detected"":false}",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
SHEET,,DIV,,,lookup,false,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
SHEET,,data,,,data,false,A1:AC357,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
SHEET,,BearPutSpread,,,output,false,C1:T58,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
INPUT,INP_000001,data,data!E7,,input,false,,data!D7,ticker_equity,,MSFT US,Underlying ticker input,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
INPUT,INP_000002,data,data!E8,,input,false,,data!D8,ticker_option,,,Long option symbol input,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
INPUT,INP_000003,data,data!E9,,input,false,,data!D9,ticker_option,,,Short option symbol input,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
INPUT,INP_000004,data,data!E10,,input,false,,data!D10,quantity,,10,Contracts,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
INPUT,INP_000005,data,data!E11,,input,false,,data!D11,other,,Buy,Rating label,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
INPUT,INP_000006,data,data!E12,,input,false,,data!D12,other,,600,Target label,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
INPUT,INP_000007,data,data!E13,,input,false,,,other,,Most Preferred,Preference tag,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
LEAF_OUTPUT,,BearPutSpread,BearPutSpread!N1,,output,false,,,,,,,,"=TEXT(TODAY(),""dd mmmm yyyy"")",,,,,,OUT_000001,BearPutSpread!N1,text_displayed,false,,,CALC_000001,CALC_000001 -> BearPutSpread!N1,,,,,,,,,,,,,,,,,,
LEAF_OUTPUT,,BearPutSpread,BearPutSpread!F6,,output,false,,,,,,,,"=data!E7",,,,,,OUT_000002,BearPutSpread!F6,value_displayed,false,,data!E7,INP_000001,INP_000001 -> BearPutSpread!F6,,,,,,,,,,,,,,,,,,
LEAF_OUTPUT,,BearPutSpread,BearPutSpread!N6,,output,false,,,,,,,,"=_xll.BDP(data!C4,""High 52Week"")",,,,,,OUT_000003,BearPutSpread!N6,text_displayed,false,,data!C4,BBG_000001,BBG_000001 -> BearPutSpread!N6,,,,,,,,,,,,,,,,,,
LEAF_OUTPUT,,BearPutSpread,BearPutSpread!F7,,output,false,,,,,,,,"=data!X4",,,,,,OUT_000004,BearPutSpread!F7,value_displayed,false,,data!X4,BBG_000001,BBG_000001 -> BearPutSpread!F7,,,,,,,,,,,,,,,,,,
LEAF_OUTPUT,,BearPutSpread,BearPutSpread!N7,,output,false,,,,,,,,"=_xll.BDP(data!C4,""low 52Week"")",,,,,,OUT_000005,BearPutSpread!N7,text_displayed,false,,data!C4,BBG_000001,BBG_000001 -> BearPutSpread!N7,,,,,,,,,,,,,,,,,,
LEAF_OUTPUT,,BearPutSpread,BearPutSpread!F8,,output,false,,,,,,,,"=data!E4",,,,,,OUT_000006,BearPutSpread!F8,value_displayed,false,,data!E4,BBG_000001,BBG_000001 -> BearPutSpread!F8,,,,,,,,,,,,,,,,,,
LEAF_OUTPUT,,BearPutSpread,BearPutSpread!N8,,output,false,,,,,,,,"=J12F13100",,,,,,OUT_000007,BearPutSpread!N8,value_displayed,false,,BearPutSpread!J12;BearPutSpread!F13,,BearPutSpread!N8,,,,,,,,,,,,,,,,,,
LEAF_OUTPUT,,BearPutSpread,BearPutSpread!Q8,,output,false,,,,,,,,"=N14/N8",,,,,,OUT_000008,BearPutSpread!Q8,value_displayed,false,,BearPutSpread!N14;BearPutSpread!N8,,BearPutSpread!Q8,,,,,,,,,,,,,,,,,,
LEAF_OUTPUT,,BearPutSpread,BearPutSpread!F9,,output,false,,,,,,,,"=_xll.BDP(data!C4,""Chg Pct 1D"")/100",,,,,,OUT_000009,BearPutSpread!F9,text_displayed,false,,data!C4,BBG_000001,BBG_000001 -> BearPutSpread!F9,,,,,,,,,,,,,,,,,,
LEAF_OUTPUT,,BearPutSpread,BearPutSpread!N9,,output,false,,,,,,,,"=J12100",,,,,,OUT_000010,BearPutSpread!N9,value_displayed,false,,BearPutSpread!J12,,BearPutSpread!N9,,,,,,,,,,,,,,,,,,
LEAF_OUTPUT,,BearPutSpread,BearPutSpread!F10,,output,false,,,,,,,,"=_xll.BDP(data!C4,""Chg NET 1D"")",,,,,,OUT_000011,BearPutSpread!F10,text_displayed,false,,data!C4,BBG_000001,BBG_000001 -> BearPutSpread!F10,,,,,,,,,,,,,,,,,,
LEAF_OUTPUT,,BearPutSpread,BearPutSpread!T11,,output,false,,,,,,,,"=32.8/17.2",,,,,,OUT_000012,BearPutSpread!T11,value_displayed,false,,,,BearPutSpread!T11,,,,,,,,,,,,,,,,,,
LEAF_OUTPUT,,BearPutSpread,BearPutSpread!F12,,output,false,,,,,,,,"=data!J4",,,,,,OUT_000013,BearPutSpread!F12,value_displayed,false,,data!J4,,BearPutSpread!F12,,,,,,,,,,,,,,,,,,
LEAF_OUTPUT,,BearPutSpread,BearPutSpread!G12,,output,false,,,,,,,,"=_xll.BDP(data!E$9,""opt expire dt"")",,,,,,OUT_000014,BearPutSpread!G12,text_displayed,false,,data!E9,BBG_000001;INP_000003,BBG_000001;INP_000003 -> BearPutSpread!G12,,,,,,,,,,,,,,,,,,
LEAF_OUTPUT,,BearPutSpread,BearPutSpread!J12,,output,false,,,,,,,,"=data!E10",,,,,,OUT_000015,BearPutSpread!J12,value_displayed,false,,data!E10,INP_000004,INP_000004 -> BearPutSpread!J12,,,,,,,,,,,,,,,,,,
LEAF_OUTPUT,,BearPutSpread,BearPutSpread!K12,,output,false,,,,,,,,"=F12",,,,,,OUT_000016,BearPutSpread!K12,value_displayed,false,,BearPutSpread!F12,,BearPutSpread!K12,,,,,,,,,,,,,,,,,,
LEAF_OUTPUT,,BearPutSpread,BearPutSpread!L12,,output,false,,,,,,,,"=F13&"" Strike Put @ $""&TEXT(F15,""0.00"")",,,,,,OUT_000017,BearPutSpread!L12,text_displayed,false,,BearPutSpread!F15;BearPutSpread!F13,BBG_000001,BBG_000001 -> BearPutSpread!L12,,,,,,,,,,,,,,,,,,
LEAF_OUTPUT,,BearPutSpread,BearPutSpread!N12,,output,false,,,,,,,,"=(F15100)J12-1",,,,,,OUT_000018,BearPutSpread!N12,value_displayed,false,,BearPutSpread!F15;BearPutSpread!J12,BBG_000001,BBG_000001 -> BearPutSpread!N12,,,,,,,,,,,,,,,,,,
LEAF_OUTPUT,,BearPutSpread,BearPutSpread!F13,,output,false,,,,,,,,"=data!G4",,,,,,OUT_000019,BearPutSpread!F13,value_displayed,false,,data!G4,BBG_000001,BBG_000001 -> BearPutSpread!F13,,,,,,,,,,,,,,,,,,
LEAF_OUTPUT,,BearPutSpread,BearPutSpread!G13,,output,false,,,,,,,,"=_xll.BDP(data!E$9,""opt strike px"")",,,,,,OUT_000020,BearPutSpread!G13,text_displayed,false,,data!E9,BBG_000001;INP_000003,BBG_000001;INP_000003 -> BearPutSpread!G13,,,,,,,,,,,,,,,,,,
LEAF_OUTPUT,,BearPutSpread,BearPutSpread!J13,,output,false,,,,,,,,"=J12",,,,,,OUT_000021,BearPutSpread!J13,value_displayed,false,,BearPutSpread!J12,,BearPutSpread!J13,,,,,,,,,,,,,,,,,,
LEAF_OUTPUT,,BearPutSpread,BearPutSpread!K13,,output,false,,,,,,,,"=F12",,,,,,OUT_000022,BearPutSpread!K13,value_displayed,false,,BearPutSpread!F12,,BearPutSpread!K13,,,,,,,,,,,,,,,,,,
LEAF_OUTPUT,,BearPutSpread,BearPutSpread!L13,,output,false,,,,,,,,"=G13&"" Strike Put @ $""&TEXT(G15,""0.00"")",,,,,,OUT_000023,BearPutSpread!L13,text_displayed,false,,BearPutSpread!G13;BearPutSpread!G15,BBG_000001,BBG_000001 -> BearPutSpread!L13,,,,,,,,,,,,,,,,,,
LEAF_OUTPUT,,BearPutSpread,BearPutSpread!N13,,output,false,,,,,,,,"=(G15100)J13",,,,,,OUT_000024,BearPutSpread!N13,value_displayed,false,,BearPutSpread!J13;BearPutSpread!G15,,BearPutSpread!N13,,,,,,,,,,,,,,,,,,
LEAF_OUTPUT,,BearPutSpread,BearPutSpread!F14,,output,false,,,,,,,,"=data!AB4",,,,,,OUT_000025,BearPutSpread!F14,value_displayed,false,,data!AB4,,BearPutSpread!F14,,,,,,,,,,,,,,,,,,
LEAF_OUTPUT,,BearPutSpread,BearPutSpread!G14,,output,false,,,,,,,,"=(G13-F8)/F8",,,,,,OUT_000026,BearPutSpread!G14,value_displayed,false,,BearPutSpread!F8;BearPutSpread!G13,BBG_000001,BBG_000001 -> BearPutSpread!G14,,,,,,,,,,,,,,,,,,
LEAF_OUTPUT,,BearPutSpread,BearPutSpread!M14,,output,false,,,,,,,,"=(F15-G15)-1",,,,,,OUT_000027,BearPutSpread!M14,value_displayed,false,,BearPutSpread!F15;BearPutSpread!G15,BBG_000001,BBG_000001 -> BearPutSpread!M14,,,,,,,,,,,,,,,,,,
LEAF_OUTPUT,,BearPutSpread,BearPutSpread!N14,,output,false,,,,,,,,"=SUM(N12:O13)",,,,,,OUT_000028,BearPutSpread!N14,value_displayed,false,,BearPutSpread!O13;BearPutSpread!N12,,BearPutSpread!N14,,,,,,,,,,,,,,,,,,
LEAF_OUTPUT,,BearPutSpread,BearPutSpread!F15,,output,false,,,,,,,,"=ROUNDUP(_xll.BDP(data!E$8,""px MID""),1)",,,,,,OUT_000029,BearPutSpread!F15,text_displayed,false,,data!E8,BBG_000001;INP_000002,BBG_000001;INP_000002 -> BearPutSpread!F15,,,,,,,,,,,,,,,,,,
LEAF_OUTPUT,,BearPutSpread,BearPutSpread!O15,,output,false,,,,,,,,"=Q8",,,,,,OUT_000030,BearPutSpread!O15,value_displayed,false,,BearPutSpread!Q8,,BearPutSpread!O15,,,,,,,,,,,,,,,,,,
LEAF_OUTPUT,,BearPutSpread,BearPutSpread!F16,,output,false,,,,,,,,"=_xll.BDP(data!E$8,""opt delta mid"")",,,,,,OUT_000031,BearPutSpread!F16,text_displayed,false,,data!E8,BBG_000001;INP_000002,BBG_000001;INP_000002 -> BearPutSpread!F16,,,,,,,,,,,,,,,,,,
LEAF_OUTPUT,,BearPutSpread,BearPutSpread!G16,,output,false,,,,,,,,"=_xll.BDP(data!E$9,""opt delta mid"")-1",,,,,,OUT_000032,BearPutSpread!G16,text_displayed,false,,data!E9,BBG_000001;INP_000003,BBG_000001;INP_000003 -> BearPutSpread!G16,,,,,,,,,,,,,,,,,,
LEAF_OUTPUT,,BearPutSpread,BearPutSpread!M16,,output,false,,,,,,,,"=F13-(F15-G15)",,,,,,OUT_000033,BearPutSpread!M16,value_displayed,false,,BearPutSpread!F15;BearPutSpread!F13;BearPutSpread!G15,BBG_000001,BBG_000001 -> BearPutSpread!M16,,,,,,,,,,,,,,,,,,
LEAF_OUTPUT,,BearPutSpread,BearPutSpread!N16,,output,false,,,,,,,,"=(M16-F8)/F8",,,,,,OUT_000034,BearPutSpread!N16,value_displayed,false,,BearPutSpread!F8;BearPutSpread!M16,,BearPutSpread!N16,,,,,,,,,,,,,,,,,,
LEAF_OUTPUT,,BearPutSpread,BearPutSpread!F17,,output,false,,,,,,,,"=F16+G16",,,,,,OUT_000035,BearPutSpread!F17,value_displayed,false,,BearPutSpread!G16;BearPutSpread!F16,BBG_000001,BBG_000001 -> BearPutSpread!F17,,,,,,,,,,,,,,,,,,
LEAF_OUTPUT,,BearPutSpread,BearPutSpread!M17,,output,false,,,,,,,,"=G13",,,,,,OUT_000036,BearPutSpread!M17,value_displayed,false,,BearPutSpread!G13,BBG_000001,BBG_000001 -> BearPutSpread!M17,,,,,,,,,,,,,,,,,,
LEAF_OUTPUT,,BearPutSpread,BearPutSpread!N17,,output,false,,,,,,,,"=(M17-F8)/F8",,,,,,OUT_000037,BearPutSpread!N17,value_displayed,false,,BearPutSpread!F8;BearPutSpread!M17,,BearPutSpread!N17,,,,,,,,,,,,,,,,,,
LEAF_OUTPUT,,BearPutSpread,BearPutSpread!F18,,output,false,,,,,,,,"=F12-TODAY()",,,,,,OUT_000038,BearPutSpread!F18,value_displayed,false,,BearPutSpread!F12,CALC_000001,CALC_000001 -> BearPutSpread!F18,,,,,,,,,,,,,,,,,,
LEAF_OUTPUT,,BearPutSpread,BearPutSpread!G18,,output,false,,,,,,,,"=G12-TODAY()",,,,,,OUT_000039,BearPutSpread!G18,value_displayed,false,,BearPutSpread!G12,BBG_000001;CALC_000001,BBG_000001;CALC_000001 -> BearPutSpread!G18,,,,,,,,,,,,,,,,,,
LEAF_OUTPUT,,BearPutSpread,BearPutSpread!I18,,output,false,,,,,,,,"=""Max hedge profit if ""&F7&"" is at or below the short ""&G13&"" strike at expiration""",,,,,,OUT_000040,BearPutSpread!I18,text_displayed,false,,BearPutSpread!F7;BearPutSpread!G13,BBG_000001,BBG_000001 -> BearPutSpread!I18,,,,,,,,,,,,,,,,,,
LEAF_OUTPUT,,BearPutSpread,BearPutSpread!M18,,output,false,,,,,,,,"=M16-M17",,,,,,OUT_000041,BearPutSpread!M18,value_displayed,false,,BearPutSpread!M16;BearPutSpread!M17,,BearPutSpread!M18,,,,,,,,,,,,,,,,,,
LEAF_OUTPUT,,BearPutSpread,BearPutSpread!N18,,output,false,,,,,,,,"=(M18*J12)*100",,,,,,OUT_000042,BearPutSpread!N18,value_displayed,false,,BearPutSpread!J12;BearPutSpread!M18,,BearPutSpread!N18,,,,,,,,,,,,,,,,,,
LEAF_OUTPUT,,BearPutSpread,BearPutSpread!Q21,,output,false,,,,,,,,"=""Max Profit of ""&TEXT(M18,""$0.00"")&"" per share or ""&TEXT(R21,""$#,##"")&"" total.""",,,,,,OUT_000043,BearPutSpread!Q21,text_displayed,false,,BearPutSpread!R21;BearPutSpread!M18,,BearPutSpread!Q21,,,,,,,,,,,,,,,,,,
LEAF_OUTPUT,,BearPutSpread,BearPutSpread!R21,,output,false,,,,,,,,"=ROUND(N18,2)",,,,,,OUT_000044,BearPutSpread!R21,value_displayed,false,,BearPutSpread!N18,,BearPutSpread!R21,,,,,,,,,,,,,,,,,,
LEAF_OUTPUT,,BearPutSpread,BearPutSpread!C22,,output,false,,,,,,,,"=F7&"" trading above strike price of ""&""$""&F13",,,,,,OUT_000045,BearPutSpread!C22,text_displayed,false,,BearPutSpread!F7;BearPutSpread!F13,,BearPutSpread!C22,,,,,,,,,,,,,,,,,,
LEAF_OUTPUT,,BearPutSpread,BearPutSpread!F22,,output,false,,,,,,,,"=""If at expiration, the ""&F7&"" is trading above the long put strike of ""&TEXT(F13,""$0"")&"", both of the put positions will expire worthless and the investor will have a loss equal to the initial investment of ""&TEXT(M14,""$0.00"")&"" per share or ""&TEXT(N14,""$#,###0.00"")&"" total for a ""&J12&""x spread.""",,,,,,OUT_000046,BearPutSpread!F22,text_displayed,false,,BearPutSpread!M14;BearPutSpread!J12;BearPutSpread!N14,,BearPutSpread!F22,,,,,,,,,,,,,,,,,,
LEAF_OUTPUT,,BearPutSpread,BearPutSpread!Q22,,output,false,,,,,,,,"=""Maximum loss of ""&TEXT(M14,""$0.00"")&"" per share or ""&TEXT(N14,""$#,###0"")&"" total.""",,,,,,OUT_000047,BearPutSpread!Q22,text_displayed,false,,BearPutSpread!N14;BearPutSpread!M14,,BearPutSpread!Q22,,,,,,,,,,,,,,,,,,
LEAF_OUTPUT,,BearPutSpread,BearPutSpread!Q23,,output,false,,,,,,,,"=F7&"" Current Stock / ETF Price of ""&TEXT(F8,""$0.00"")",,,,,,OUT_000048,BearPutSpread!Q23,text_displayed,false,,BearPutSpread!F8;BearPutSpread!F7,,BearPutSpread!Q23,,,,,,,,,,,,,,,,,,
LEAF_OUTPUT,,BearPutSpread,BearPutSpread!C26,,output,false,,,,,,,,"=F7&"" trading between long put strike of ""&TEXT(F13,""$0"")&"" and short put strike of ""&TEXT(G13,""$0"")",,,,,,OUT_000049,BearPutSpread!C26,text_displayed,false,,BearPutSpread!F7;BearPutSpread!G13;BearPutSpread!F13,BBG_000001,BBG_000001 -> BearPutSpread!C26,,,,,,,,,,,,,,,,,,
LEAF_OUTPUT,,BearPutSpread,BearPutSpread!F26,,output,false,,,,,,,,"=""If at expiration, the ""&F7&"" is trading between the long put strike of ""&F13&"" and the short put strike of ""&G13&""; the intrinsic value of the spread will be the difference between the long put strike and the price of ""&F6&"" at expiration. The investor's hedge profit or loss will be the value of the spread minus the initial investment, which in this case is a net debit of ""&TEXT(M14,""$0.00"")&"" ""&""(""&TEXT(N14,""$#,###0.00"")&"" total for ""&J12&"" contracts)""&"" creating a breakeven of ""&TEXT(M16,""$#,###0.00"")&"".""",,,,,,OUT_000050,BearPutSpread!F26,text_displayed,false,,BearPutSpread!M14;BearPutSpread!M16;BearPutSpread!J12,BBG_000001,BBG_000001 -> BearPutSpread!F26,,,,,,,,,,,,,,,,,,
LEAF_OUTPUT,,BearPutSpread,BearPutSpread!C30,,output,false,,,,,,,,"=F7&"" trading below strike price of ""&TEXT(G13,""$0"")",,,,,,OUT_000051,BearPutSpread!C30,text_displayed,false,,BearPutSpread!F7;BearPutSpread!G13,BBG_000001,BBG_000001 -> BearPutSpread!C30,,,,,,,,,,,,,,,,,,
LEAF_OUTPUT,,BearPutSpread,BearPutSpread!F30,,output,false,,,,,,,,"=""If the ""&F7&"" is trading below the short put strike of ""&G13&"" at expiration, the investor will have a maximum hedge gain of ""&TEXT(M18,""$#,###0.00"")&"" or the difference between the breakeven of ""&TEXT(M16,""$#,###0.00"")&"" and the short put strike of ""&TEXT(G13,""$#,###0"")&"".""",,,,,,OUT_000052,BearPutSpread!F30,text_displayed,false,,BearPutSpread!M16;BearPutSpread!F7;BearPutSpread!G13,BBG_000001,BBG_000001 -> BearPutSpread!F30,,,,,,,,,,,,,,,,,,
LEAF_OUTPUT,,BearPutSpread,BearPutSpread!Q30,,output,false,,,,,,,,"=""Breakeven Price ""&TEXT(M16,""$#,###0.00"")",,,,,,OUT_000053,BearPutSpread!Q30,text_displayed,false,,BearPutSpread!M16,,BearPutSpread!Q30,,,,,,,,,,,,,,,,,,
LEAF_OUTPUT,,BearPutSpread,BearPutSpread!Q31,,output,false,,,,,,,,"=TEXT(F13,""0"")&"" Long Put Strike""",,,,,,OUT_000054,BearPutSpread!Q31,text_displayed,false,,BearPutSpread!F13,,BearPutSpread!Q31,,,,,,,,,,,,,,,,,,
LEAF_OUTPUT,,BearPutSpread,BearPutSpread!Q32,,output,false,,,,,,,,"=G13&"" Short Put Strike""",,,,,,OUT_000055,BearPutSpread!Q32,text_displayed,false,,BearPutSpread!G13,BBG_000001,BBG_000001 -> BearPutSpread!Q32,,,,,,,,,,,,,,,,,,
LEAF_OUTPUT,,BearPutSpread,BearPutSpread!D56,,output,false,,,,,,,,"=""*Pricing is HIGHLY indicative on the close ""&TEXT(TODAY()-1,""mmmm dd yyyy"")",,,,,,OUT_000056,BearPutSpread!D56,text_displayed,false,,,CALC_000001,CALC_000001 -> BearPutSpread!D56,,,,,,,,,,,,,,,,,,
LEAF_OUTPUT,,BearPutSpread,BearPutSpread!I56,,output,false,,,,,,,,"=NOW()",,,,,,OUT_000057,BearPutSpread!I56,value_displayed,false,,,CALC_000001,CALC_000001 -> BearPutSpread!I56,,,,,,,,,,,,,,,,,,
PYTHON_INJECTION,,,,,,,,,,,,Stable user input block feeding option/underlying identifiers and marketing fields.,,,,,,,,,,,,,,,inputs_block,other,array_2d,INJ_000001,data!E7:E13,P0,OUT_000002;OUT_000003;OUT_000004;OUT_000005;OUT_000006;OUT_000009;OUT_000011;OUT_000025;OUT_000026;OUT_000034;OUT_000037;OUT_000040;OUT_000045;OUT_000046;OUT_000048;OUT_000049;OUT_000050;OUT_000051;OUT_000052,BearPutSpread!F6;BearPutSpread!N6;BearPutSpread!F7;BearPutSpread!N7;BearPutSpread!F8;BearPutSpread!F9;BearPutSpread!F10;BearPutSpread!F14;BearPutSpread!G14;BearPutSpread!N16;BearPutSpread!N17;BearPutSpread!I18;BearPutSpread!C22;BearPutSpread!F22;BearPutSpread!Q23;BearPutSpread!C26;BearPutSpread!F26;BearPutSpread!C30;BearPutSpread!F30,,,,,,,,,,
PYTHON_INJECTION,,,,,,,,,,,,"Replaces Bloomberg BDP outputs for underlying + long option leg (spot/strike/expiry/premium/iv/delta, etc.). Includes volatile DAY/EXPIRE derived fields.",,,,,,,,,,,,,,,underlying_and_leg1_snapshot,market_data,array_2d,INJ_000002,data!E4:O4,P0,OUT_000006;OUT_000025;OUT_000026;OUT_000034;OUT_000037;OUT_000048,BearPutSpread!F8;BearPutSpread!F14;BearPutSpread!G14;BearPutSpread!N16;BearPutSpread!N17;BearPutSpread!Q23,,,,,,,,,,
PYTHON_INJECTION,,,,,,,,,,,,Replaces Bloomberg name and GICS sector descriptors displayed on template.,,,,,,,,,,,,,,,underlying_name_and_sector,market_data,array_2d,INJ_000003,data!X4:Y4,P0,OUT_000004;OUT_000040;OUT_000045;OUT_000046;OUT_000048;OUT_000049;OUT_000050;OUT_000051;OUT_000052,BearPutSpread!F7;BearPutSpread!I18;BearPutSpread!C22;BearPutSpread!F22;BearPutSpread!Q23;BearPutSpread!C26;BearPutSpread!F26;BearPutSpread!C30;BearPutSpread!F30,,,,,,,,,,
PYTHON_INJECTION,,,,,,,,,,,,Output sheet contains Bloomberg formula; must be overwritten by Python value.,,,,,,,,,,,,,,,high_52w,market_data,number,INJ_000004,BearPutSpread!N6,P0,OUT_000003,BearPutSpread!N6,,,,,,,,,,
PYTHON_INJECTION,,,,,,,,,,,,Output sheet contains Bloomberg formula; must be overwritten by Python value.,,,,,,,,,,,,,,,low_52w,market_data,number,INJ_000005,BearPutSpread!N7,P0,OUT_000005,BearPutSpread!N7,,,,,,,,,,
PYTHON_INJECTION,,,,,,,,,,,,Output sheet contains Bloomberg formula; must be overwritten by Python value.,,,,,,,,,,,,,,,chg_pct_1d,market_data,number,INJ_000006,BearPutSpread!F9,P0,OUT_000009,BearPutSpread!F9,,,,,,,,,,
PYTHON_INJECTION,,,,,,,,,,,,Output sheet contains Bloomberg formula; must be overwritten by Python value.,,,,,,,,,,,,,,,chg_net_1d,market_data,number,INJ_000007,BearPutSpread!F10,P0,OUT_000011,BearPutSpread!F10,,,,,,,,,,
PYTHON_INJECTION,,,,,,,,,,,,Output sheet contains Bloomberg formula; must be overwritten by Python value.,,,,,,,,,,,,,,,leg1_expiry_date,leg_params,date,INJ_000008,BearPutSpread!G12,P0,OUT_000014;OUT_000039,BearPutSpread!G12;BearPutSpread!G18,,,,,,,,,,
PYTHON_INJECTION,,,,,,,,,,,,Output sheet contains Bloomberg formula; must be overwritten by Python value.,,,,,,,,,,,,,,,leg2_strike,leg_params,number,INJ_000009,BearPutSpread!G13,P0,OUT_000020;OUT_000023;OUT_000026;OUT_000036;OUT_000037;OUT_000040;OUT_000041;OUT_000042;OUT_000043;OUT_000044;OUT_000049;OUT_000050;OUT_000051;OUT_000052;OUT_000055,BearPutSpread!G13;BearPutSpread!L13;BearPutSpread!G14;BearPutSpread!M17;BearPutSpread!N17;BearPutSpread!I18;BearPutSpread!M18;BearPutSpread!N18;BearPutSpread!Q21;BearPutSpread!R21;BearPutSpread!C26;BearPutSpread!F26;BearPutSpread!C30;BearPutSpread!F30;BearPutSpread!Q32,,,,,,,,,,
PYTHON_INJECTION,,,,,,,,,,,,Output sheet contains Bloomberg formula; must be overwritten by Python value.,,,,,,,,,,,,,,,leg1_premium_mid,leg_params,number,INJ_000010,BearPutSpread!F15,P0,OUT_000008;OUT_000017;OUT_000018;OUT_000027;OUT_000028;OUT_000029;OUT_000030;OUT_000033;OUT_000034;OUT_000041;OUT_000042;OUT_000043;OUT_000044;OUT_000046;OUT_000047;OUT_000050;OUT_000052;OUT_000053,BearPutSpread!Q8;BearPutSpread!L12;BearPutSpread!N12;BearPutSpread!M14;BearPutSpread!N14;BearPutSpread!F15;BearPutSpread!O15;BearPutSpread!M16;BearPutSpread!N16;BearPutSpread!M18;BearPutSpread!N18;BearPutSpread!Q21;BearPutSpread!R21;BearPutSpread!F22;BearPutSpread!Q22;BearPutSpread!F26;BearPutSpread!F30;BearPutSpread!Q30,,,,,,,,,,
PYTHON_INJECTION,,,,,,,,,,,,Output sheet contains Bloomberg formula; must be overwritten by Python value.,,,,,,,,,,,,,,,leg1_delta_mid,leg_params,number,INJ_000011,BearPutSpread!F16,P0,OUT_000031;OUT_000035,BearPutSpread!F16;BearPutSpread!F17,,,,,,,,,,
PYTHON_INJECTION,,,,,,,,,,,,Output sheet contains Bloomberg formula; must be overwritten by Python value.,,,,,,,,,,,,,,,leg2_delta_mid,leg_params,number,INJ_000012,BearPutSpread!G16,P0,OUT_000032;OUT_000035,BearPutSpread!G16;BearPutSpread!F17,,,,,,,,,,
PYTHON_INJECTION,,,,,,,,,,,,Replaces TODAY()-based display date for deterministic PDF.,,,,,,,,,,,,,,,as_of_date_text,print_meta,text,INJ_000013,BearPutSpread!N1,P0,OUT_000001,BearPutSpread!N1,,,,,,,,,,
PYTHON_INJECTION,,,,,,,,,,,,Replaces TODAY()-1 pricing note text for deterministic PDF.,,,,,,,,,,,,,,,pricing_note_as_of_text,print_meta,text,INJ_000014,BearPutSpread!D56,P0,OUT_000056,BearPutSpread!D56,,,,,,,,,,
PYTHON_INJECTION,,,,,,,,,,,,Avoids TODAY() dependence for days-to-expiry display.,,,,,,,,,,,,,,,days_to_expiry_long,strategy_metrics,number,INJ_000015,BearPutSpread!F18,P1,OUT_000038,BearPutSpread!F18,,,,,,,,,,
PYTHON_INJECTION,,,,,,,,,,,,Avoids TODAY() dependence for days-to-expiry display.,,,,,,,,,,,,,,,days_to_expiry_short,strategy_metrics,number,INJ_000016,BearPutSpread!G18,P1,OUT_000039,BearPutSpread!G18,,,,,,,,,,
PYTHON_INJECTION,,,,,,,,,,,,NOW() timestamp; may be hidden/print driver.,,,,,,,,,,,,,,,calc_timestamp,print_meta,date,INJ_000017,BearPutSpread!I56,P2,OUT_000057,BearPutSpread!I56,,,,,,,,,,
BLOOMBERG_FIELD,BBG_000001,BearPutSpread,BearPutSpread!F10,,,,,,,,,Representative Bloomberg add-in formulas (_xll.BDP/_xll.BDS) exist; Python should overwrite their destination cells instead of relying on add-in.,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
CALCULATION,CALC_000001,,,,,,,,,,,Volatile functions TODAY/NOW used; prefer Python injection into downstream stable cells where possible.,,volatile,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
LEGS_SUMMARY,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,2,data!E8:E9;BearPutSpread!F12:G16,,,,,,,,,
LEG_FIELD,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,2,data!E8:E9;BearPutSpread!F12:G16,1,BearPutSpread!F12,BearPutSpread!F12,BearPutSpread!F13,BearPutSpread!F12,BearPutSpread!F15,BearPutSpread!F16,,
LEG_FIELD,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,2,data!E8:E9;BearPutSpread!F12:G16,2,BearPutSpread!K13,BearPutSpread!K13,BearPutSpread!G13,BearPutSpread!K12,BearPutSpread!G15,BearPutSpread!G16,,
FLAG,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,EXTERNAL_LINK,Workbook contains Excel externalLinks parts; at least one formula references external workbook. Example: data!U4 has broken ref.
FLAG,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,NAMED_RANGE_DETECTED,"Named ranges present (count=2). Notably: expire, EXPIRES -> data! #REF! (broken)."
FLAG,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,VOLATILE_FUNCTION,"Volatile functions detected in 8 cells (TODAY/NOW/OFFSET/INDIRECT). Key ones on output: BearPutSpread!N1,D56,F18,G18,I56; on data: A2,I4,J4."
